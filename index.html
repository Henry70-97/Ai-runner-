<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Runner - Run AI Tasks. Earn Instantly.</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; padding: 0; }
    body { font-family: 'Rajdhani', sans-serif; }
    .font-orbitron { font-family: 'Orbitron', sans-serif; }
    
    .video-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -2;
      opacity: 0.3;
      filter: blur(2px);
    }
    
    .overlay-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(10, 10, 30, 0.85) 0%, rgba(20, 10, 40, 0.9) 50%, rgba(10, 20, 50, 0.85) 100%);
      z-index: -1;
    }
    
    .neon-card {
      background: linear-gradient(145deg, rgba(20, 20, 50, 0.9), rgba(30, 20, 60, 0.8));
      border: 1px solid rgba(100, 200, 255, 0.3);
      box-shadow: 0 0 20px rgba(100, 200, 255, 0.15), inset 0 0 30px rgba(100, 200, 255, 0.05);
      backdrop-filter: blur(10px);
    }
    
    .neon-card-alt {
      background: linear-gradient(145deg, rgba(40, 20, 60, 0.9), rgba(60, 30, 80, 0.8));
      border: 1px solid rgba(200, 100, 255, 0.3);
      box-shadow: 0 0 20px rgba(200, 100, 255, 0.15), inset 0 0 30px rgba(200, 100, 255, 0.05);
      backdrop-filter: blur(10px);
    }
    
    .neon-card-gold {
      background: linear-gradient(145deg, rgba(60, 50, 20, 0.9), rgba(80, 60, 30, 0.8));
      border: 1px solid rgba(255, 200, 100, 0.4);
      box-shadow: 0 0 25px rgba(255, 200, 100, 0.2), inset 0 0 30px rgba(255, 200, 100, 0.05);
      backdrop-filter: blur(10px);
    }
    
    .neon-glow {
      text-shadow: 0 0 10px rgba(100, 200, 255, 0.8), 0 0 20px rgba(100, 200, 255, 0.5), 0 0 30px rgba(100, 200, 255, 0.3);
    }
    
    .neon-glow-purple {
      text-shadow: 0 0 10px rgba(200, 100, 255, 0.8), 0 0 20px rgba(200, 100, 255, 0.5);
    }
    
    .neon-glow-gold {
      text-shadow: 0 0 10px rgba(255, 200, 100, 0.8), 0 0 20px rgba(255, 200, 100, 0.5);
    }
    
    .btn-neon {
      background: linear-gradient(135deg, #00d4ff, #0099cc);
      box-shadow: 0 0 15px rgba(0, 212, 255, 0.4), 0 4px 15px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
    }
    
    .btn-neon:hover {
      box-shadow: 0 0 25px rgba(0, 212, 255, 0.6), 0 6px 20px rgba(0, 0, 0, 0.4);
      transform: translateY(-2px);
    }
    
    .btn-neon-gold {
      background: linear-gradient(135deg, #ffd700, #ffaa00);
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.4), 0 4px 15px rgba(0, 0, 0, 0.3);
    }
    
    .btn-neon-gold:hover {
      box-shadow: 0 0 25px rgba(255, 215, 0, 0.6), 0 6px 20px rgba(0, 0, 0, 0.4);
      transform: translateY(-2px);
    }
    
    .btn-neon-purple {
      background: linear-gradient(135deg, #c850c0, #8a2be2);
      box-shadow: 0 0 15px rgba(200, 80, 192, 0.4), 0 4px 15px rgba(0, 0, 0, 0.3);
    }
    
    .btn-neon-purple:hover {
      box-shadow: 0 0 25px rgba(200, 80, 192, 0.6), 0 6px 20px rgba(0, 0, 0, 0.4);
      transform: translateY(-2px);
    }
    
    .flag-border {
      position: relative;
      overflow: hidden;
    }
    
    .flag-border::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, 
        #006b3f 0%, #006b3f 8.33%, 
        #ce1126 8.33%, #ce1126 16.66%,
        #fcd116 16.66%, #fcd116 25%,
        #000000 25%, #000000 33.33%,
        #009639 33.33%, #009639 41.66%,
        #ef2929 41.66%, #ef2929 50%,
        #009b3a 50%, #009b3a 58.33%,
        #fedd00 58.33%, #fedd00 66.66%,
        #e03c31 66.66%, #e03c31 75%,
        #0072c6 75%, #0072c6 83.33%,
        #007a5e 83.33%, #007a5e 91.66%,
        #ce1126 91.66%, #ce1126 100%
      );
      background-size: 200% 100%;
      animation: flagScroll 8s linear infinite;
    }
    
    .flag-border::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, 
        #ce1126 0%, #ce1126 8.33%,
        #007a5e 8.33%, #007a5e 16.66%,
        #0072c6 16.66%, #0072c6 25%,
        #e03c31 25%, #e03c31 33.33%,
        #fedd00 33.33%, #fedd00 41.66%,
        #009b3a 41.66%, #009b3a 50%,
        #ef2929 50%, #ef2929 58.33%,
        #009639 58.33%, #009639 66.66%,
        #000000 66.66%, #000000 75%,
        #fcd116 75%, #fcd116 83.33%,
        #ce1126 83.33%, #ce1126 91.66%,
        #006b3f 91.66%, #006b3f 100%
      );
      background-size: 200% 100%;
      animation: flagScrollReverse 8s linear infinite;
    }
    
    @keyframes flagScroll {
      0% { background-position: 0% 0%; }
      100% { background-position: 200% 0%; }
    }
    
    @keyframes flagScrollReverse {
      0% { background-position: 200% 0%; }
      100% { background-position: 0% 0%; }
    }
    
    .rotating-progress {
      width: 40px;
      height: 40px;
      border: 3px solid rgba(100, 200, 255, 0.2);
      border-top-color: #00d4ff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    .rotating-progress-gold {
      border-top-color: #ffd700;
    }
    
    .rotating-progress-purple {
      border-top-color: #c850c0;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .animate-slideIn {
      animation: slideIn 0.5s ease forwards;
    }
    
    .modal-overlay {
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(5px);
    }
    
    .scrollbar-thin::-webkit-scrollbar {
      width: 6px;
    }
    
    .scrollbar-thin::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 3px;
    }
    
    .scrollbar-thin::-webkit-scrollbar-thumb {
      background: rgba(100, 200, 255, 0.5);
      border-radius: 3px;
    }
    
    .task-locked {
      position: relative;
      opacity: 0.6;
    }
    
    .task-locked::after {
      content: 'üîí Premium';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 200, 100, 0.9);
      color: #000;
      padding: 4px 12px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 12px;
    }
    
    .toast {
      animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s forwards;
    }
    
    @keyframes fadeOut {
      to { opacity: 0; transform: translateY(-20px); }
    }
  </style>
</head>
<body class="h-full overflow-auto scrollbar-thin text-white">
  <video class="video-bg" autoplay muted loop playsinline>
    <source src="video.mp4" type="video/mp4">
  </video>
  <div class="overlay-bg"></div>
  
  <div id="app" class="min-h-full w-full">
    <!-- Toast Container -->
    <div id="toastContainer" class="fixed top-4 right-4 z-50 flex flex-col gap-2"></div>
    
    <!-- Landing Page -->
    <div id="landingPage" class="min-h-full w-full">
      <!-- Navbar -->
      <nav class="flag-border sticky top-0 z-40 bg-gradient-to-r from-slate-900/95 via-purple-900/95 to-slate-900/95 backdrop-blur-md py-4">
        <div class="max-w-7xl mx-auto px-4 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center">
              <span class="font-orbitron font-bold text-lg">AI</span>
            </div>
            <span class="font-orbitron font-bold text-xl neon-glow">AI Runner</span>
          </div>
          
          <div class="hidden md:flex items-center gap-6">
            <a href="#how-it-works" class="text-cyan-300 hover:text-cyan-100 transition font-medium">How It Works</a>
            <a href="#plans" class="text-cyan-300 hover:text-cyan-100 transition font-medium">Plans</a>
            <button onclick="showModal('loginModal')" class="text-cyan-300 hover:text-cyan-100 transition font-medium">Login</button>
            <button onclick="showModal('registerModal')" class="btn-neon px-6 py-2 rounded-full font-semibold text-white">Join Free</button>
          </div>
          
          <button onclick="toggleMobileMenu()" class="md:hidden text-cyan-300 p-2">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobileMenu" class="hidden md:hidden bg-slate-900/95 border-t border-cyan-500/30 mt-4">
          <div class="px-4 py-4 flex flex-col gap-4">
            <a href="#how-it-works" class="text-cyan-300 hover:text-cyan-100 transition font-medium py-2">How It Works</a>
            <a href="#plans" class="text-cyan-300 hover:text-cyan-100 transition font-medium py-2">Plans</a>
            <button onclick="showModal('loginModal')" class="text-cyan-300 hover:text-cyan-100 transition font-medium py-2 text-left">Login</button>
            <button onclick="showModal('registerModal')" class="btn-neon px-6 py-3 rounded-full font-semibold text-white w-full">Join Free</button>
          </div>
        </div>
      </nav>
      
      <!-- Hero Section -->
      <section class="py-20 px-4">
        <div class="max-w-6xl mx-auto text-center">
          <div class="flex justify-center mb-6">
            <div class="rotating-progress"></div>
          </div>
          <h1 id="heroHeadline" class="font-orbitron text-4xl md:text-6xl font-bold mb-6 neon-glow">
            Run AI Tasks. Earn Instantly.
          </h1>
          <p id="heroSubtext" class="text-xl md:text-2xl text-cyan-200 mb-10 max-w-3xl mx-auto">
            Complete AI microtasks and get paid <span class="text-green-400 font-bold">$0.01 ‚Äì $4</span> per task. Join thousands earning from AI training tasks.
          </p>
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <button onclick="showModal('registerModal')" class="btn-neon px-10 py-4 rounded-full font-bold text-lg">
              üöÄ Join Free
            </button>
            <button onclick="showModal('upgradeModal')" class="btn-neon-gold px-10 py-4 rounded-full font-bold text-lg text-slate-900">
              ‚≠ê Upgrade to Premium
            </button>
          </div>
        </div>
      </section>
      
      <!-- How It Works Section -->
      <section id="how-it-works" class="py-20 px-4 bg-gradient-to-b from-transparent via-purple-900/30 to-transparent">
        <div class="max-w-6xl mx-auto">
          <div class="text-center mb-12">
            <div class="flex justify-center mb-4">
              <div class="rotating-progress rotating-progress-purple"></div>
            </div>
            <h2 class="font-orbitron text-3xl md:text-4xl font-bold neon-glow-purple mb-4">How AI Runner Works</h2>
            <p class="text-purple-200 text-lg">Start earning in 3 simple steps</p>
          </div>
          
          <div class="grid md:grid-cols-3 gap-8">
            <div class="neon-card flag-border rounded-2xl p-8 text-center animate-slideIn" style="animation-delay: 0.1s">
              <div class="w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center text-4xl">
                1Ô∏è‚É£
              </div>
              <h3 class="font-orbitron text-xl font-bold mb-4 text-cyan-300">Register</h3>
              <p class="text-gray-300">Create your free account in seconds. No credit card required to start.</p>
            </div>
            
            <div class="neon-card-alt flag-border rounded-2xl p-8 text-center animate-slideIn" style="animation-delay: 0.2s">
              <div class="w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-purple-400 to-pink-600 flex items-center justify-center text-4xl">
                2Ô∏è‚É£
              </div>
              <h3 class="font-orbitron text-xl font-bold mb-4 text-purple-300">Complete AI Tasks</h3>
              <p class="text-gray-300">Choose from 100+ AI tasks: data tagging, translations, prompt testing & more.</p>
            </div>
            
            <div class="neon-card-gold flag-border rounded-2xl p-8 text-center animate-slideIn" style="animation-delay: 0.3s">
              <div class="w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-yellow-400 to-orange-600 flex items-center justify-center text-4xl">
                3Ô∏è‚É£
              </div>
              <h3 class="font-orbitron text-xl font-bold mb-4 text-yellow-300">Earn & Withdraw</h3>
              <p class="text-gray-300">Get paid per task. Withdraw via Bank or PayPal once you reach the threshold.</p>
            </div>
          </div>
        </div>
      </section>
      
      <!-- Plans Section -->
      <section id="plans" class="py-20 px-4">
        <div class="max-w-6xl mx-auto">
          <div class="text-center mb-12">
            <div class="flex justify-center mb-4">
              <div class="rotating-progress rotating-progress-gold"></div>
            </div>
            <h2 class="font-orbitron text-3xl md:text-4xl font-bold neon-glow-gold mb-4">Choose Your Plan</h2>
            <p class="text-yellow-200 text-lg">Start free or unlock premium earning potential</p>
          </div>
          
          <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
            <!-- Free Plan -->
            <div class="neon-card flag-border rounded-2xl p-8 animate-slideIn">
              <div class="text-center mb-8">
                <span class="text-5xl mb-4 block">üÜì</span>
                <h3 class="font-orbitron text-2xl font-bold text-cyan-300 mb-2">Free Plan</h3>
                <p class="text-4xl font-bold text-white">$0<span class="text-lg text-gray-400">/forever</span></p>
              </div>
              
              <ul class="space-y-4 mb-8">
                <li class="flex items-center gap-3">
                  <span class="text-green-400">‚úì</span>
                  <span>Access to basic AI microtasks</span>
                </li>
                <li class="flex items-center gap-3">
                  <span class="text-green-400">‚úì</span>
                  <span>Earn <strong class="text-cyan-300">$0.01 ‚Äì $1</strong> per task</span>
                </li>
                <li class="flex items-center gap-3">
                  <span class="text-green-400">‚úì</span>
                  <span>Limited daily tasks (20/day)</span>
                </li>
                <li class="flex items-center gap-3">
                  <span class="text-yellow-400">‚ö†</span>
                  <span>Minimum withdrawal: <strong>$20 (KSH 2,580)</strong></span>
                </li>
                <li class="flex items-center gap-3">
                  <span class="text-yellow-400">‚ö†</span>
                  <span>Withdrawal after 25 days</span>
                </li>
                <li class="flex items-center gap-3">
                  <span class="text-green-400">‚úì</span>
                  <span>Bank, PayPal & MPESA withdrawal</span>
                </li>
              </ul>
              
              <button onclick="showModal('registerModal')" class="btn-neon w-full py-4 rounded-full font-bold text-lg">
                Get Started Free
              </button>
            </div>
            
            <!-- Premium Plan -->
            <div class="neon-card-gold flag-border rounded-2xl p-8 animate-slideIn relative overflow-visible" style="animation-delay: 0.1s">
              <div class="absolute -top-4 left-1/2 -translate-x-1/2 bg-gradient-to-r from-yellow-400 to-orange-500 px-6 py-2 rounded-full text-slate-900 font-bold text-sm">
                üî• MOST POPULAR
              </div>
              
              <div class="text-center mb-8 mt-4">
                <span class="text-5xl mb-4 block">üëë</span>
                <h3 class="font-orbitron text-2xl font-bold text-yellow-300 mb-2">Premium Plan</h3>
                <p class="text-4xl font-bold text-white">KSH 357<span class="text-lg text-gray-400">/one-time</span></p>
              </div>
              
              <ul class="space-y-4 mb-8">
                <li class="flex items-center gap-3">
                  <span class="text-green-400">‚úì</span>
                  <span>Access to <strong class="text-yellow-300">high-paying</strong> AI tasks</span>
                </li>
                <li class="flex items-center gap-3">
                  <span class="text-green-400">‚úì</span>
                  <span>Earn <strong class="text-yellow-300">$0.50 ‚Äì $4</strong> per task</span>
                </li>
                <li class="flex items-center gap-3">
                  <span class="text-green-400">‚úì</span>
                  <span><strong class="text-yellow-300">Unlimited</strong> daily tasks</span>
                </li>
                <li class="flex items-center gap-3">
                  <span class="text-green-400">‚úì</span>
                  <span>Priority task access</span>
                </li>
                <li class="flex items-center gap-3">
                  <span class="text-green-400">‚úì</span>
                  <span>Withdraw <strong class="text-yellow-300">2x per week</strong></span>
                </li>
                <li class="flex items-center gap-3">
                  <span class="text-green-400">‚úì</span>
                  <span>Lower minimum: <strong>$5</strong></span>
                </li>
              </ul>
              
              <button onclick="showModal('upgradeModal')" class="btn-neon-gold w-full py-4 rounded-full font-bold text-lg text-slate-900">
                ‚≠ê Upgrade Now - KSH 357
              </button>
            </div>
          </div>
        </div>
      </section>
      
      <!-- Footer -->
      <footer class="flag-border py-10 px-4 bg-slate-900/80">
        <div class="max-w-6xl mx-auto text-center">
          <div class="flex items-center justify-center gap-2 mb-4">
            <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center">
              <span class="font-orbitron font-bold text-sm">AI</span>
            </div>
            <span class="font-orbitron font-bold text-lg">AI Runner</span>
          </div>
          <p class="text-gray-400 mb-4">Empowering AI training through microtasks</p>
          <p class="text-gray-500 text-sm">¬© 2024 AI Runner. All rights reserved.</p>
        </div>
      </footer>
    </div>
    
    <!-- Dashboard Page -->
    <div id="dashboardPage" class="min-h-full w-full hidden">
      <!-- Dashboard Navbar -->
      <nav class="flag-border sticky top-0 z-40 bg-gradient-to-r from-slate-900/95 via-purple-900/95 to-slate-900/95 backdrop-blur-md py-4">
        <div class="max-w-7xl mx-auto px-4 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center">
              <span class="font-orbitron font-bold text-lg">AI</span>
            </div>
            <span class="font-orbitron font-bold text-xl neon-glow">AI Runner</span>
          </div>
          
          <div class="flex items-center gap-4">
            <div id="userBadge" class="hidden md:flex items-center gap-2 bg-slate-800/50 px-4 py-2 rounded-full">
              <span id="userPlanBadge" class="text-xs px-2 py-1 rounded-full bg-cyan-500/20 text-cyan-300">FREE</span>
              <span id="userName" class="text-sm font-medium">User</span>
            </div>
            
            <button onclick="toggleDashboardMenu()" class="text-cyan-300 p-2">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
              </svg>
            </button>
          </div>
        </div>
        
        <!-- Dashboard Menu -->
        <div id="dashboardMenu" class="hidden bg-slate-900/95 border-t border-cyan-500/30 mt-4">
          <div class="px-4 py-4 flex flex-col gap-2">
            <button onclick="showDashboardSection('dashboard')" class="flex items-center gap-3 text-cyan-300 hover:bg-cyan-500/10 px-4 py-3 rounded-lg transition text-left">
              <span>üìä</span> Dashboard
            </button>
            <button onclick="showDashboardSection('tasks')" class="flex items-center gap-3 text-cyan-300 hover:bg-cyan-500/10 px-4 py-3 rounded-lg transition text-left">
              <span>ü§ñ</span> AI Tasks
            </button>
            <button onclick="showDashboardSection('wallet')" class="flex items-center gap-3 text-cyan-300 hover:bg-cyan-500/10 px-4 py-3 rounded-lg transition text-left">
              <span>üí∞</span> Wallet
            </button>
            <button onclick="showDashboardSection('plans')" class="flex items-center gap-3 text-cyan-300 hover:bg-cyan-500/10 px-4 py-3 rounded-lg transition text-left">
              <span>üìã</span> Plans
            </button>
            <button onclick="handleExternalLink('chat')" class="flex items-center gap-3 text-purple-300 hover:bg-purple-500/10 px-4 py-3 rounded-lg transition text-left">
              <span>üí¨</span> Chat and Earn
            </button>
            <button onclick="handleExternalLink('prime')" class="flex items-center gap-3 text-purple-300 hover:bg-purple-500/10 px-4 py-3 rounded-lg transition text-left">
              <span>üé¨</span> Prime Watch
            </button>
            <button onclick="showDashboardSection('history')" class="flex items-center gap-3 text-cyan-300 hover:bg-cyan-500/10 px-4 py-3 rounded-lg transition text-left">
              <span>üìà</span> Earnings History
            </button>
            <button onclick="showModal('supportModal')" class="flex items-center gap-3 text-cyan-300 hover:bg-cyan-500/10 px-4 py-3 rounded-lg transition text-left">
              <span>üõü</span> Support
            </button>
            <button onclick="handleLogout()" class="flex items-center gap-3 text-red-400 hover:bg-red-500/10 px-4 py-3 rounded-lg transition text-left">
              <span>üö™</span> Logout
            </button>
          </div>
        </div>
      </nav>
      
      <!-- Dashboard Content -->
      <div id="dashboardContent" class="max-w-7xl mx-auto px-4 py-8">
        <!-- Main Dashboard Section -->
        <div id="dashboardSection" class="space-y-8">
          <div class="flex justify-center mb-4">
            <div class="rotating-progress"></div>
          </div>
          
          <h2 class="font-orbitron text-2xl md:text-3xl font-bold neon-glow">Welcome back, <span id="dashboardUserName">User</span>!</h2>
          
          <!-- Wallet Card -->
          <div class="neon-card-gold flag-border rounded-2xl p-6 md:p-8">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6">
              <div>
                <p class="text-yellow-200 text-sm mb-2">Available Balance</p>
                <div class="flex items-baseline gap-2">
                  <span id="walletBalance" class="font-orbitron text-4xl md:text-5xl font-bold text-yellow-300 neon-glow-gold">$0.00</span>
                  <button onclick="toggleCurrency()" class="text-sm text-yellow-400 hover:text-yellow-300 underline">
                    (<span id="balanceKsh">KSH 0</span>)
                  </button>
                </div>
                <p class="text-yellow-200/70 text-sm mt-2">1 USD = KSH 129</p>
              </div>
              
              <div class="flex gap-4">
                <button onclick="showModal('addFundsModal')" class="btn-neon px-6 py-3 rounded-full font-semibold">
                  üí≥ Add Funds
                </button>
                <button onclick="showModal('withdrawModal')" class="btn-neon-gold px-6 py-3 rounded-full font-semibold text-slate-900">
                  üí∏ Withdraw
                </button>
              </div>
            </div>
          </div>
          
          <!-- Stats Grid -->
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="neon-card flag-border rounded-xl p-4 text-center">
              <p class="text-cyan-300 text-sm mb-1">Tasks Completed</p>
              <p id="tasksCompleted" class="font-orbitron text-2xl font-bold">0</p>
            </div>
            <div class="neon-card-alt flag-border rounded-xl p-4 text-center">
              <p class="text-purple-300 text-sm mb-1">Total Earned</p>
              <p id="totalEarned" class="font-orbitron text-2xl font-bold">$0.00</p>
            </div>
            <div class="neon-card flag-border rounded-xl p-4 text-center">
              <p class="text-cyan-300 text-sm mb-1">Today's Tasks</p>
              <p id="todayTasks" class="font-orbitron text-2xl font-bold">0/20</p>
            </div>
            <div class="neon-card-gold flag-border rounded-xl p-4 text-center">
              <p class="text-yellow-300 text-sm mb-1">Account Type</p>
              <p id="accountType" class="font-orbitron text-2xl font-bold">FREE</p>
            </div>
          </div>
          
          <!-- Recent Activity -->
          <div class="neon-card flag-border rounded-2xl p-6">
            <h3 class="font-orbitron text-xl font-bold text-cyan-300 mb-6">üìã Recent Activity</h3>
            <div id="recentActivity" class="space-y-4 max-h-64 overflow-y-auto scrollbar-thin">
              <p class="text-gray-400 text-center py-4">No recent activity yet. Start completing tasks!</p>
            </div>
          </div>
          
          <!-- Quick Tasks -->
          <div class="neon-card-alt flag-border rounded-2xl p-6">
            <div class="flex items-center justify-between mb-6">
              <h3 class="font-orbitron text-xl font-bold text-purple-300">ü§ñ Available Tasks</h3>
              <button onclick="showDashboardSection('tasks')" class="text-purple-300 hover:text-purple-100 text-sm underline">View All</button>
            </div>
            <div id="quickTasks" class="grid gap-4">
              <!-- Tasks will be populated by JS -->
            </div>
          </div>
        </div>
        
        <!-- Tasks Section -->
        <div id="tasksSection" class="hidden space-y-8">
          <div class="flex justify-center mb-4">
            <div class="rotating-progress rotating-progress-purple"></div>
          </div>
          
          <h2 class="font-orbitron text-2xl md:text-3xl font-bold neon-glow-purple">ü§ñ AI Tasks</h2>
          
          <!-- Task Categories -->
          <div class="flex flex-wrap gap-2 mb-6">
            <button onclick="filterTasks('all')" class="task-filter-btn active px-4 py-2 rounded-full bg-cyan-500/20 text-cyan-300 hover:bg-cyan-500/30 transition text-sm font-medium" data-filter="all">All Tasks</button>
            <button onclick="filterTasks('chat')" class="task-filter-btn px-4 py-2 rounded-full bg-slate-700/50 text-gray-300 hover:bg-slate-700/80 transition text-sm font-medium" data-filter="chat">AI Chat Missions</button>
            <button onclick="filterTasks('rewrite')" class="task-filter-btn px-4 py-2 rounded-full bg-slate-700/50 text-gray-300 hover:bg-slate-700/80 transition text-sm font-medium" data-filter="rewrite">Rewrite & Improve</button>
            <button onclick="filterTasks('translation')" class="task-filter-btn px-4 py-2 rounded-full bg-slate-700/50 text-gray-300 hover:bg-slate-700/80 transition text-sm font-medium" data-filter="translation">Translation</button>
            <button onclick="filterTasks('prompt')" class="task-filter-btn px-4 py-2 rounded-full bg-slate-700/50 text-gray-300 hover:bg-slate-700/80 transition text-sm font-medium" data-filter="prompt">Prompt Challenges</button>
            <button onclick="filterTasks('teach')" class="task-filter-btn px-4 py-2 rounded-full bg-slate-700/50 text-gray-300 hover:bg-slate-700/80 transition text-sm font-medium" data-filter="teach">AI Teach</button>
          </div>
          
          <div id="tasksList" class="grid gap-4">
            <!-- Tasks will be populated by JS -->
          </div>
        </div>
        
        <!-- Wallet Section -->
        <div id="walletSection" class="hidden space-y-8">
          <div class="flex justify-center mb-4">
            <div class="rotating-progress rotating-progress-gold"></div>
          </div>
          
          <h2 class="font-orbitron text-2xl md:text-3xl font-bold neon-glow-gold">üí∞ Wallet</h2>
          
          <!-- Balance Card -->
          <div class="neon-card-gold flag-border rounded-2xl p-8">
            <div class="text-center">
              <p class="text-yellow-200 text-lg mb-4">Current Balance</p>
              <p id="walletBalanceLarge" class="font-orbitron text-5xl md:text-6xl font-bold text-yellow-300 neon-glow-gold mb-2">$0.00</p>
              <p id="walletBalanceKsh" class="text-yellow-200/70 text-xl">KSH 0</p>
            </div>
            
            <div class="flex flex-col sm:flex-row gap-4 justify-center mt-8">
              <button onclick="showModal('addFundsModal')" class="btn-neon px-8 py-4 rounded-full font-semibold text-lg">
                üí≥ Add Funds
              </button>
              <button onclick="showModal('withdrawModal')" class="btn-neon-gold px-8 py-4 rounded-full font-semibold text-lg text-slate-900">
                üí∏ Withdraw
              </button>
            </div>
          </div>
          
          <!-- Withdrawal Info -->
          <div class="grid md:grid-cols-2 gap-6">
            <div class="neon-card flag-border rounded-xl p-6">
              <h4 class="font-orbitron text-lg font-bold text-cyan-300 mb-4">Free Plan Withdrawal</h4>
              <ul class="space-y-3 text-gray-300">
                <li>‚Ä¢ Minimum: <strong class="text-cyan-300">$20 (KSH 2,580)</strong></li>
                <li>‚Ä¢ Available after: <strong class="text-cyan-300">25 days</strong></li>
                <li>‚Ä¢ Methods: MPESA, Bank, PayPal</li>
                <li>‚Ä¢ Processing: 3-5 business days</li>
              </ul>
            </div>
            <div class="neon-card-gold flag-border rounded-xl p-6">
              <h4 class="font-orbitron text-lg font-bold text-yellow-300 mb-4">Premium Withdrawal</h4>
              <ul class="space-y-3 text-gray-300">
                <li>‚Ä¢ Minimum: <strong class="text-yellow-300">$5 (KSH 645)</strong></li>
                <li>‚Ä¢ Withdraw: <strong class="text-yellow-300">2x per week</strong></li>
                <li>‚Ä¢ Methods: MPESA, Bank, PayPal</li>
                <li>‚Ä¢ Processing: 1-2 business days</li>
              </ul>
            </div>
          </div>
        </div>
        
        <!-- Plans Section (Dashboard) -->
        <div id="plansSection" class="hidden space-y-8">
          <div class="flex justify-center mb-4">
            <div class="rotating-progress"></div>
          </div>
          
          <h2 class="font-orbitron text-2xl md:text-3xl font-bold neon-glow">üìã Plans</h2>
          
          <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
            <!-- Same plan cards as landing page -->
            <div class="neon-card flag-border rounded-2xl p-8">
              <div class="text-center mb-8">
                <span class="text-5xl mb-4 block">üÜì</span>
                <h3 class="font-orbitron text-2xl font-bold text-cyan-300 mb-2">Free Plan</h3>
                <p class="text-4xl font-bold text-white">$0</p>
              </div>
              <ul class="space-y-3 mb-8 text-sm">
                <li class="flex items-center gap-2"><span class="text-green-400">‚úì</span> Basic AI microtasks</li>
                <li class="flex items-center gap-2"><span class="text-green-400">‚úì</span> Earn $0.01 ‚Äì $1 per task</li>
                <li class="flex items-center gap-2"><span class="text-green-400">‚úì</span> 20 tasks/day limit</li>
                <li class="flex items-center gap-2"><span class="text-yellow-400">‚ö†</span> $20 min withdrawal</li>
                <li class="flex items-center gap-2"><span class="text-yellow-400">‚ö†</span> 25-day waiting period</li>
              </ul>
              <div id="freePlanBtn" class="text-center text-cyan-300 font-medium">Current Plan</div>
            </div>
            
            <div class="neon-card-gold flag-border rounded-2xl p-8">
              <div class="text-center mb-8">
                <span class="text-5xl mb-4 block">üëë</span>
                <h3 class="font-orbitron text-2xl font-bold text-yellow-300 mb-2">Premium Plan</h3>
                <p class="text-4xl font-bold text-white">KSH 357</p>
              </div>
              <ul class="space-y-3 mb-8 text-sm">
                <li class="flex items-center gap-2"><span class="text-green-400">‚úì</span> High-paying AI tasks</li>
                <li class="flex items-center gap-2"><span class="text-green-400">‚úì</span> Earn $0.50 ‚Äì $4 per task</li>
                <li class="flex items-center gap-2"><span class="text-green-400">‚úì</span> Unlimited daily tasks</li>
                <li class="flex items-center gap-2"><span class="text-green-400">‚úì</span> $5 min withdrawal</li>
                <li class="flex items-center gap-2"><span class="text-green-400">‚úì</span> 2x per week withdrawals</li>
              </ul>
              <button id="premiumPlanBtn" onclick="showModal('upgradeModal')" class="btn-neon-gold w-full py-3 rounded-full font-bold text-slate-900">
                ‚≠ê Upgrade Now
              </button>
            </div>
          </div>
        </div>
        
        <!-- History Section -->
        <div id="historySection" class="hidden space-y-8">
          <div class="flex justify-center mb-4">
            <div class="rotating-progress rotating-progress-purple"></div>
          </div>
          
          <h2 class="font-orbitron text-2xl md:text-3xl font-bold neon-glow-purple">üìà Earnings History</h2>
          
          <div class="neon-card flag-border rounded-2xl p-6">
            <div id="earningsHistory" class="space-y-4 max-h-96 overflow-y-auto scrollbar-thin">
              <p class="text-gray-400 text-center py-8">No earnings history yet. Complete tasks to start earning!</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- MODALS -->
    
    <!-- Register Modal -->
    <div id="registerModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4 modal-overlay">
      <div class="neon-card flag-border rounded-2xl p-8 w-full max-w-md animate-slideIn">
        <div class="flex items-center justify-between mb-6">
          <h3 class="font-orbitron text-xl font-bold text-cyan-300">üöÄ Join AI Runner</h3>
          <button onclick="hideModal('registerModal')" class="text-gray-400 hover:text-white text-2xl">&times;</button>
        </div>
        
        <form id="registerForm" onsubmit="handleRegister(event)" class="space-y-4">
          <div>
            <label class="block text-sm text-gray-300 mb-2">Full Name</label>
            <input type="text" name="name" required class="w-full bg-slate-800/50 border border-cyan-500/30 rounded-lg px-4 py-3 text-white focus:border-cyan-400 focus:outline-none" placeholder="John Doe">
          </div>
          <div>
            <label class="block text-sm text-gray-300 mb-2">Email Address</label>
            <input type="email" name="email" required class="w-full bg-slate-800/50 border border-cyan-500/30 rounded-lg px-4 py-3 text-white focus:border-cyan-400 focus:outline-none" placeholder="john@example.com">
          </div>
          <div>
            <label class="block text-sm text-gray-300 mb-2">Phone Number</label>
            <input type="tel" name="phone" required class="w-full bg-slate-800/50 border border-cyan-500/30 rounded-lg px-4 py-3 text-white focus:border-cyan-400 focus:outline-none" placeholder="+254...">
          </div>
          <div>
            <label class="block text-sm text-gray-300 mb-2">Create Password</label>
            <input type="password" name="password" required minlength="6" class="w-full bg-slate-800/50 border border-cyan-500/30 rounded-lg px-4 py-3 text-white focus:border-cyan-400 focus:outline-none" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
          </div>
          
          <button type="submit" class="btn-neon w-full py-4 rounded-full font-bold text-lg">
            Create Account
          </button>
          
          <p class="text-center text-gray-400 text-sm">
            Already have an account? <button type="button" onclick="switchModal('registerModal', 'loginModal')" class="text-cyan-300 hover:underline">Login</button>
          </p>
        </form>
      </div>
    </div>
    
    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4 modal-overlay">
      <div class="neon-card-alt flag-border rounded-2xl p-8 w-full max-w-md animate-slideIn">
        <div class="flex items-center justify-between mb-6">
          <h3 class="font-orbitron text-xl font-bold text-purple-300">üîê Login</h3>
          <button onclick="hideModal('loginModal')" class="text-gray-400 hover:text-white text-2xl">&times;</button>
        </div>
        
        <form id="loginForm" onsubmit="handleLogin(event)" class="space-y-4">
          <div>
            <label class="block text-sm text-gray-300 mb-2">Email Address</label>
            <input type="email" name="email" required class="w-full bg-slate-800/50 border border-purple-500/30 rounded-lg px-4 py-3 text-white focus:border-purple-400 focus:outline-none" placeholder="john@example.com">
          </div>
          <div>
            <label class="block text-sm text-gray-300 mb-2">Password</label>
            <input type="password" name="password" required class="w-full bg-slate-800/50 border border-purple-500/30 rounded-lg px-4 py-3 text-white focus:border-purple-400 focus:outline-none" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
          </div>
          
          <button type="submit" class="btn-neon-purple w-full py-4 rounded-full font-bold text-lg text-white">
            Login
          </button>
          
          <p class="text-center text-gray-400 text-sm">
            Don't have an account? <button type="button" onclick="switchModal('loginModal', 'registerModal')" class="text-purple-300 hover:underline">Register</button>
          </p>
        </form>
      </div>
    </div>
    
    <!-- Upgrade Modal -->
    <div id="upgradeModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4 modal-overlay">
      <div class="neon-card-gold flag-border rounded-2xl p-8 w-full max-w-md max-h-[90%] overflow-y-auto scrollbar-thin animate-slideIn">
        <div class="flex items-center justify-between mb-6">
          <h3 class="font-orbitron text-xl font-bold text-yellow-300">üëë Upgrade to Premium</h3>
          <button onclick="hideModal('upgradeModal')" class="text-gray-400 hover:text-white text-2xl">&times;</button>
        </div>
        
        <div id="upgradeStep1" class="space-y-6">
          <div class="text-center mb-6">
            <p class="text-5xl mb-4">‚≠ê</p>
            <p class="text-3xl font-bold text-yellow-300 mb-2">KSH 357</p>
            <p class="text-gray-300">One-Time Payment</p>
          </div>
          
          <ul class="space-y-3 mb-8">
            <li class="flex items-center gap-2 text-gray-300"><span class="text-green-400">‚úì</span> High-paying tasks ($0.50 - $4)</li>
            <li class="flex items-center gap-2 text-gray-300"><span class="text-green-400">‚úì</span> Unlimited daily tasks</li>
            <li class="flex items-center gap-2 text-gray-300"><span class="text-green-400">‚úì</span> 2x per week withdrawals</li>
            <li class="flex items-center gap-2 text-gray-300"><span class="text-green-400">‚úì</span> Priority support</li>
          </ul>
          
          <div class="space-y-3">
            <button onclick="showUpgradePaymentStep()" class="btn-neon-gold w-full py-4 rounded-full font-bold text-lg text-slate-900">
              üí≥ Pay KSH 357 via MPESA
            </button>
            
            <button onclick="toggleUpgradeAlternative()" class="w-full text-yellow-300 hover:text-yellow-200 py-3 text-sm underline transition">
              Already subscribed? Click here
            </button>
          </div>
        </div>
        
        <!-- Alternative: Already Subscribed Section -->
        <div id="upgradeAlternative" class="hidden space-y-4">
          <p class="text-gray-300 text-sm">Paste your MPESA confirmation message to activate Premium instantly.</p>
          
          <div class="bg-slate-800/50 border border-yellow-500/30 rounded-lg p-3">
            <label class="block text-xs text-gray-300 mb-2">üì± MPESA Confirmation Message:</label>
            <textarea id="mpesaMessage" rows="3" class="w-full bg-slate-900/50 border border-yellow-500/20 rounded px-2 py-2 text-white focus:border-yellow-400 focus:outline-none resize-none text-xs" placeholder="Paste your MPESA message here..."></textarea>
          </div>
          
          <div id="mpesaValidationFeedback" class="hidden space-y-1 text-xs">
            <div class="flex items-center gap-2">
              <span id="checkRecipient" class="inline-block w-4 h-4 rounded-full bg-slate-700 flex items-center justify-center text-xs font-bold">?</span>
              <span class="text-gray-400">Lipana Technologies Limited</span>
            </div>
            <div class="flex items-center gap-2">
              <span id="checkAmount" class="inline-block w-4 h-4 rounded-full bg-slate-700 flex items-center justify-center text-xs font-bold">?</span>
              <span class="text-gray-400">KSH 357</span>
            </div>
            <div class="flex items-center gap-2">
              <span id="checkDate" class="inline-block w-4 h-4 rounded-full bg-slate-700 flex items-center justify-center text-xs font-bold">?</span>
              <span class="text-gray-400">Today's date</span>
            </div>
          </div>
          
          <div class="flex gap-2 pt-2">
            <button onclick="toggleUpgradeAlternative()" class="flex-1 bg-slate-700 hover:bg-slate-600 py-2 rounded-full font-semibold text-xs transition">
              Back
            </button>
            <button onclick="verifyMpesaMessage()" class="flex-1 btn-neon-gold py-2 rounded-full font-bold text-slate-900 text-xs">
              Verify & Activate
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Add Funds Modal -->
    <div id="addFundsModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4 modal-overlay">
      <div class="neon-card flag-border rounded-2xl p-8 w-full max-w-md animate-slideIn">
        <div class="flex items-center justify-between mb-6">
          <h3 class="font-orbitron text-xl font-bold text-cyan-300">üí≥ Add Funds</h3>
          <button onclick="hideModal('addFundsModal')" class="text-gray-400 hover:text-white text-2xl">&times;</button>
        </div>
        
        <p class="text-gray-300 mb-6 text-center">Add funds to your wallet to unlock premium features or boost your account.</p>
        
        <a href="https://lipana.dev/pay/home-trade-top-up" target="_blank" rel="noopener noreferrer" class="btn-neon block w-full py-4 rounded-full font-bold text-lg text-center">
          üí≥ Add Funds via Lipana
        </a>
      </div>
    </div>
    
    <!-- Withdraw Modal -->
    <div id="withdrawModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4 modal-overlay">
      <div class="neon-card-alt flag-border rounded-2xl p-8 w-full max-w-md animate-slideIn">
        <div class="flex items-center justify-between mb-6">
          <h3 class="font-orbitron text-xl font-bold text-purple-300">üí∏ Withdraw Funds</h3>
          <button onclick="hideModal('withdrawModal')" class="text-gray-400 hover:text-white text-2xl">&times;</button>
        </div>
        
        <form id="withdrawForm" onsubmit="handleWithdraw(event)" class="space-y-4">
          <div>
            <label class="block text-sm text-gray-300 mb-2">Amount (USD)</label>
            <input type="number" name="amount" required min="5" step="0.01" class="w-full bg-slate-800/50 border border-purple-500/30 rounded-lg px-4 py-3 text-white focus:border-purple-400 focus:outline-none" placeholder="20.00">
          </div>
          <div>
            <label class="block text-sm text-gray-300 mb-2">Withdrawal Method</label>
            <select name="method" required onchange="updateWithdrawalFields()" class="w-full bg-slate-800/50 border border-purple-500/30 rounded-lg px-4 py-3 text-white focus:border-purple-400 focus:outline-none">
              <option value="">Select method...</option>
              <option value="mpesa">üì± MPESA (Kenya)</option>
              <option value="bank">üè¶ Bank Transfer</option>
              <option value="paypal">üí≥ PayPal</option>
            </select>
          </div>
          
          <div id="mpesaFields" class="hidden space-y-3">
            <div>
              <label class="block text-sm text-gray-300 mb-2">MPESA Phone Number</label>
              <input type="tel" name="mpesa_phone" class="w-full bg-slate-800/50 border border-purple-500/30 rounded-lg px-4 py-3 text-white focus:border-purple-400 focus:outline-none" placeholder="+254712345678">
            </div>
            <div class="bg-blue-500/10 border border-blue-500/30 rounded-lg p-3 text-xs text-blue-300">
              ‚ÑπÔ∏è Enter your MPESA phone number. You'll receive a prompt to enter your PIN.
            </div>
          </div>
          
          <div id="bankFields" class="hidden space-y-3">
            <div>
              <label class="block text-sm text-gray-300 mb-2">Account Details</label>
              <textarea name="bank_details" rows="3" class="w-full bg-slate-800/50 border border-purple-500/30 rounded-lg px-4 py-3 text-white focus:border-purple-400 focus:outline-none resize-none" placeholder="Enter your bank account number..."></textarea>
            </div>
          </div>
          
          <div id="paypalFields" class="hidden space-y-3">
            <div>
              <label class="block text-sm text-gray-300 mb-2">PayPal Email</label>
              <input type="email" name="paypal_email" class="w-full bg-slate-800/50 border border-purple-500/30 rounded-lg px-4 py-3 text-white focus:border-purple-400 focus:outline-none" placeholder="your@email.com">
            </div>
          </div>
          
          <div id="withdrawInfo" class="text-sm text-yellow-300 bg-yellow-500/10 p-3 rounded-lg">
            ‚ö†Ô∏è Free plan: Min $20, after 25 days. Premium: Min $5, 2x per week.
          </div>
          
          <button type="submit" class="btn-neon-purple w-full py-4 rounded-full font-bold text-lg text-white">
            Submit Withdrawal
          </button>
        </form>
      </div>
    </div>
    
    <!-- Support Modal -->
    <div id="supportModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4 modal-overlay">
      <div class="neon-card flag-border rounded-2xl p-8 w-full max-w-md animate-slideIn">
        <div class="flex items-center justify-between mb-6">
          <h3 class="font-orbitron text-xl font-bold text-cyan-300">üõü Support</h3>
          <button onclick="hideModal('supportModal')" class="text-gray-400 hover:text-white text-2xl">&times;</button>
        </div>
        
        <form id="supportForm" onsubmit="handleSupport(event)" class="space-y-4">
          <div>
            <label class="block text-sm text-gray-300 mb-2">Subject</label>
            <select name="subject" required class="w-full bg-slate-800/50 border border-cyan-500/30 rounded-lg px-4 py-3 text-white focus:border-cyan-400 focus:outline-none">
              <option value="">Select subject...</option>
              <option value="withdrawal">Withdrawal Issue</option>
              <option value="task">Task Problem</option>
              <option value="account">Account Issue</option>
              <option value="payment">Payment Question</option>
              <option value="other">Other</option>
            </select>
          </div>
          <div>
            <label class="block text-sm text-gray-300 mb-2">Message</label>
            <textarea name="message" required rows="4" class="w-full bg-slate-800/50 border border-cyan-500/30 rounded-lg px-4 py-3 text-white focus:border-cyan-400 focus:outline-none resize-none" placeholder="Describe your issue..."></textarea>
          </div>
          
          <button type="submit" class="btn-neon w-full py-4 rounded-full font-bold text-lg">
            Send Message
          </button>
        </form>
      </div>
    </div>
    
    <!-- Task Modal -->
    <div id="taskModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4 modal-overlay">
      <div class="neon-card-gold flag-border rounded-2xl p-6 w-full max-w-2xl max-h-[90%] overflow-y-auto scrollbar-thin animate-slideIn">
        <div class="flex items-center justify-between mb-6">
          <h3 id="taskModalTitle" class="font-orbitron text-xl font-bold text-yellow-300">Task Details</h3>
          <button onclick="hideModal('taskModal')" class="text-gray-400 hover:text-white text-2xl">&times;</button>
        </div>
        
        <div id="taskModalContent" class="space-y-4">
          <!-- Task content will be populated by JS -->
        </div>
      </div>
    </div>
    
    <!-- Live Review Modal -->
    <div id="liveReviewModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4 modal-overlay">
      <div class="neon-card-gold flag-border rounded-2xl p-8 w-full max-w-2xl max-h-[90%] overflow-y-auto scrollbar-thin animate-slideIn">
        <div class="flex items-center justify-between mb-6 pb-4 border-b border-yellow-500/30">
          <h3 class="font-orbitron text-xl font-bold text-yellow-300">‚ú® Live Review & Scoring</h3>
          <button onclick="document.getElementById('liveReviewModal').classList.add('hidden'); document.getElementById('liveReviewModal').classList.remove('flex');" class="text-gray-400 hover:text-white text-2xl">&times;</button>
        </div>
        
        <div id="liveReviewContent" class="space-y-6">
          <!-- Review content will be populated by JS -->
        </div>
      </div>
    </div>
    
    <!-- External Link Modal -->
    <div id="externalLinkModal" class="fixed inset-0 z-50 hidden items-center justify-center p-4 modal-overlay">
      <div class="neon-card-alt flag-border rounded-2xl p-8 w-full max-w-md animate-slideIn">
        <div class="flex items-center justify-between mb-6">
          <h3 class="font-orbitron text-xl font-bold text-purple-300">üîó External Link</h3>
          <button onclick="hideModal('externalLinkModal')" class="text-gray-400 hover:text-white text-2xl">&times;</button>
        </div>
        
        <div class="text-center">
          <p class="text-4xl mb-4">üåê</p>
          <p id="externalLinkMessage" class="text-gray-300 mb-6">You are about to visit an external website.</p>
          <div class="flex gap-4">
            <button onclick="hideModal('externalLinkModal')" class="flex-1 bg-slate-700 hover:bg-slate-600 py-3 rounded-full font-semibold transition">
              Cancel
            </button>
            <a id="externalLinkBtn" href="#" target="_blank" rel="noopener noreferrer" class="flex-1 btn-neon-purple py-3 rounded-full font-semibold text-center text-white">
              Continue
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // ============ STATE MANAGEMENT ============
    const KSH_RATE = 129;
    const WEB3FORM_KEY = 'a0a5e898-8dde-43eb-8d36-e0c1757a3219';
    const TARGET_EMAIL = 'hankwane1@gmail.com';
    
    let currentUser = null;
    let currentFilter = 'all';
    
    // Default config for Element SDK
    const defaultConfig = {
      hero_headline: "Run AI Tasks. Earn Instantly.",
      hero_subtext: "Complete AI microtasks and get paid $0.01 ‚Äì $4 per task. Join thousands earning from AI training tasks."
    };
    
    // ============ TASKS DATABASE ============
    const tasksDatabase = {
      chat: generateChatTasks(),
      rewrite: generateRewriteTasks(),
      translation: generateTranslationTasks(),
      prompt: generatePromptTasks(),
      teach: generateTeachTasks()
    };
    
    function generateChatTasks() {
      const tasks = [];
      const phrases = [
        { text: "Hello, how are you today?", focus: "natural greeting", difficulty: "easy" },
        { text: "I would like to schedule an appointment", focus: "polite request", difficulty: "easy" },
        { text: "Could you please help me with this problem?", focus: "seeking assistance", difficulty: "easy" },
        { text: "Thank you so much for your help!", focus: "expressing gratitude", difficulty: "easy" },
        { text: "I'm sorry, but I disagree with that point", focus: "polite disagreement", difficulty: "medium" },
        { text: "Let me explain the situation more clearly", focus: "clarification", difficulty: "medium" },
        { text: "Would you mind if I asked a few questions?", focus: "permission seeking", difficulty: "medium" },
        { text: "I believe there might be a misunderstanding here", focus: "conflict resolution", difficulty: "medium" },
        { text: "In my professional opinion, we should consider...", focus: "formal advice", difficulty: "hard" },
        { text: "Based on the evidence presented, I conclude that...", focus: "logical argument", difficulty: "hard" },
        { text: "While I understand your perspective, I think we should also consider...", focus: "diplomatic disagreement", difficulty: "hard" },
        { text: "The data suggests a correlation between these factors", focus: "analytical speech", difficulty: "hard" },
        { text: "I appreciate your patience during this process", focus: "customer service", difficulty: "easy" },
        { text: "Let's explore some alternative solutions together", focus: "collaborative problem-solving", difficulty: "medium" },
        { text: "I'm confident we can find a mutually beneficial outcome", focus: "negotiation", difficulty: "hard" },
        { text: "Please don't hesitate to reach out if you need anything", focus: "offering support", difficulty: "easy" },
        { text: "I wanted to follow up on our previous conversation", focus: "continuation", difficulty: "medium" },
        { text: "To summarize the key points we discussed...", focus: "summary delivery", difficulty: "medium" },
        { text: "I'd like to propose an alternative approach", focus: "suggestion making", difficulty: "medium" },
        { text: "This situation requires careful consideration of all factors", focus: "thoughtful analysis", difficulty: "hard" }
      ];
      
      phrases.forEach((phrase, i) => {
        const isPremium = phrase.difficulty === 'hard';
        tasks.push({
          id: `chat_${i + 1}`,
          category: 'chat',
          title: `Train AI: "${phrase.text.substring(0, 30)}..."`,
          description: `Help the AI learn how to say this phrase in a natural, human-like way. Focus on ${phrase.focus}.`,
          instruction: `Listen to how the AI pronounces: "${phrase.text}"\n\nYour task:\n1. Rate the naturalness (1-10)\n2. Identify any robotic-sounding parts\n3. Suggest improvements for intonation and emphasis\n4. Provide a voice recording of how a human would say it naturally`,
          payment: isPremium ? (1.5 + Math.random() * 2.5).toFixed(2) : (0.05 + Math.random() * 0.4).toFixed(2),
          time: isPremium ? '8-12 min' : '3-5 min',
          premium: isPremium,
          phrase: phrase.text,
          focus: phrase.focus
        });
      });
      
      return tasks;
    }
    
    function generateRewriteTasks() {
      const tasks = [];
      const incorrectPhrases = [
        { incorrect: "Me and him went to store yesterday", correct: "He and I went to the store yesterday", rule: "pronoun order and article usage" },
        { incorrect: "Their going too the park to", correct: "They're going to the park too", rule: "homophones: their/they're/there, to/too/two" },
        { incorrect: "The informations was very helpfull", correct: "The information was very helpful", rule: "uncountable nouns and spelling" },
        { incorrect: "He don't knows nothing about it", correct: "He doesn't know anything about it", rule: "double negatives and subject-verb agreement" },
        { incorrect: "I should of went earlier", correct: "I should have gone earlier", rule: "modal verbs and past participles" },
        { incorrect: "Between you and I, this is wrong", correct: "Between you and me, this is wrong", rule: "objective pronouns after prepositions" },
        { incorrect: "The data shows that less people attended", correct: "The data show that fewer people attended", rule: "data as plural and fewer vs less" },
        { incorrect: "Irregardless of the outcome, we tried", correct: "Regardless of the outcome, we tried", rule: "non-standard words" },
        { incorrect: "I could care less about this", correct: "I couldn't care less about this", rule: "idiomatic expressions" },
        { incorrect: "For all intensive purposes", correct: "For all intents and purposes", rule: "commonly misheard phrases" },
        { incorrect: "The reason is because he left", correct: "The reason is that he left", rule: "redundancy in reason clauses" },
        { incorrect: "Try and fix this problem", correct: "Try to fix this problem", rule: "infinitive usage" },
        { incorrect: "I literally died laughing", correct: "I figuratively died laughing", rule: "literal vs figurative usage" },
        { incorrect: "Each of the students have their books", correct: "Each of the students has their books", rule: "subject-verb agreement with 'each'" },
        { incorrect: "Who did you give it too?", correct: "Whom did you give it to?", rule: "who vs whom" },
        { incorrect: "Me and my friends is going", correct: "My friends and I are going", rule: "pronoun placement and verb agreement" },
        { incorrect: "Supposably, it should work", correct: "Supposedly, it should work", rule: "commonly mispronounced words" },
        { incorrect: "I done finished the work", correct: "I have finished the work", rule: "auxiliary verb usage" },
        { incorrect: "Where is the party at?", correct: "Where is the party?", rule: "unnecessary prepositions" },
        { incorrect: "He's more smarter than me", correct: "He's smarter than I am", rule: "comparative adjectives and pronoun case" }
      ];
      
      incorrectPhrases.forEach((item, i) => {
        const isPremium = i > 12;
        tasks.push({
          id: `rewrite_${i + 1}`,
          category: 'rewrite',
          title: `Correct: "${item.incorrect.substring(0, 25)}..."`,
          description: `Fix the grammatical errors in this phrase. Focus on: ${item.rule}`,
          instruction: `Original (incorrect): "${item.incorrect}"\n\nYour task:\n1. Identify ALL grammatical errors\n2. Explain what rule each error violates\n3. Provide the corrected version\n4. Give a brief explanation why the correction is correct\n\nMinimum words: 50\nMaximum words: 150`,
          payment: isPremium ? (1.0 + Math.random() * 2).toFixed(2) : (0.03 + Math.random() * 0.3).toFixed(2),
          time: isPremium ? '5-8 min' : '2-4 min',
          premium: isPremium,
          incorrect: item.incorrect,
          rule: item.rule
        });
      });
      
      return tasks;
    }
    
    function generateTranslationTasks() {
      const tasks = [];
      const phrases = [
        { en: "Good morning! How did you sleep?", sw: "Habari za asubuhi! Umelala vipi?", context: "casual greeting" },
        { en: "I would like to order some food", sw: "Ningependa kuagiza chakula", context: "restaurant" },
        { en: "Where is the nearest hospital?", sw: "Hospitali ya karibu iko wapi?", context: "emergency" },
        { en: "Can you help me find my way?", sw: "Unaweza kunisaidia kupata njia yangu?", context: "directions" },
        { en: "The weather is beautiful today", sw: "Hali ya hewa ni nzuri leo", context: "small talk" },
        { en: "I need to withdraw some money", sw: "Ninahitaji kutoa pesa", context: "banking" },
        { en: "What time does the bus leave?", sw: "Basi linaondoka saa ngapi?", context: "transport" },
        { en: "Please call an ambulance immediately", sw: "Tafadhali piga simu ambulensi haraka", context: "emergency" },
        { en: "How much does this cost?", sw: "Hii bei yake ni ngapi?", context: "shopping" },
        { en: "I don't understand, please repeat", sw: "Sielewi, tafadhali rudia", context: "communication" },
        { en: "My phone battery is dead", sw: "Betri ya simu yangu imeisha", context: "technology" },
        { en: "We need to discuss this matter urgently", sw: "Tunahitaji kujadili jambo hili haraka", context: "business" },
        { en: "The children are playing in the park", sw: "Watoto wanacheza bustanini", context: "family" },
        { en: "I have a reservation under my name", sw: "Nina uhifadhi kwa jina langu", context: "hotel" },
        { en: "Please send me the documents by email", sw: "Tafadhali nitumie nyaraka kwa barua pepe", context: "office" },
        { en: "The meeting has been postponed", sw: "Mkutano umeahirishwa", context: "business" },
        { en: "I need a receipt for this purchase", sw: "Ninahitaji risiti ya ununuzi huu", context: "shopping" },
        { en: "Can you recommend a good restaurant?", sw: "Unaweza kupendekeza mkahawa mzuri?", context: "tourism" },
        { en: "I'm allergic to peanuts", sw: "Nina mzio wa karanga", context: "health" },
        { en: "The flight has been delayed by two hours", sw: "Ndege imecheleweshwa kwa masaa mawili", context: "travel" }
      ];
      
      // Add Sheng translations
      const shengPhrases = [
        { en: "What's up, how are you doing?", sheng: "Niaje, umeshindaje?", context: "youth greeting" },
        { en: "Let's go grab some food", sheng: "Tuishie kudishi", context: "casual invitation" },
        { en: "That's really cool!", sheng: "Hiyo ni poa sana!", context: "excitement" },
        { en: "I don't have any money", sheng: "Sina doo", context: "finances" },
        { en: "He's a good friend", sheng: "Yeye ni msee poa", context: "friendship" }
      ];
      
      phrases.forEach((item, i) => {
        const isPremium = i > 14;
        tasks.push({
          id: `trans_en_sw_${i + 1}`,
          category: 'translation',
          title: `EN‚ÜíSW: "${item.en.substring(0, 25)}..."`,
          description: `Translate from English to Swahili. Context: ${item.context}`,
          instruction: `English: "${item.en}"\n\nTranslate to Swahili:\n1. Provide accurate translation\n2. Ensure cultural appropriateness\n3. Maintain the tone and context: ${item.context}\n4. Explain any idiomatic expressions\n\nMinimum words: 20\nMaximum words: 80`,
          payment: isPremium ? (1.2 + Math.random() * 1.8).toFixed(2) : (0.08 + Math.random() * 0.4).toFixed(2),
          time: isPremium ? '6-10 min' : '3-5 min',
          premium: isPremium,
          sourceText: item.en,
          direction: 'EN‚ÜíSW',
          context: item.context
        });
        
        tasks.push({
          id: `trans_sw_en_${i + 1}`,
          category: 'translation',
          title: `SW‚ÜíEN: "${item.sw.substring(0, 25)}..."`,
          description: `Translate from Swahili to English. Context: ${item.context}`,
          instruction: `Swahili: "${item.sw}"\n\nTranslate to English:\n1. Provide accurate translation\n2. Maintain natural English phrasing\n3. Context: ${item.context}\n4. Note any cultural nuances\n\nMinimum words: 20\nMaximum words: 80`,
          payment: isPremium ? (1.0 + Math.random() * 1.5).toFixed(2) : (0.06 + Math.random() * 0.35).toFixed(2),
          time: isPremium ? '5-8 min' : '2-4 min',
          premium: isPremium,
          sourceText: item.sw,
          direction: 'SW‚ÜíEN',
          context: item.context
        });
      });
      
      shengPhrases.forEach((item, i) => {
        tasks.push({
          id: `trans_sheng_${i + 1}`,
          category: 'translation',
          title: `EN‚ÜîSheng: "${item.en.substring(0, 20)}..."`,
          description: `Translate between English and Sheng slang. Context: ${item.context}`,
          instruction: `English: "${item.en}"\nSheng: "${item.sheng}"\n\nYour task:\n1. Verify the Sheng translation is accurate\n2. Provide alternative Sheng expressions\n3. Explain the slang terms used\n4. Rate authenticity (1-10)\n\nMinimum words: 30\nMaximum words: 100`,
          payment: (0.8 + Math.random() * 1.2).toFixed(2),
          time: '4-6 min',
          premium: true,
          sourceText: item.en,
          direction: 'EN‚ÜîSheng',
          context: item.context
        });
      });
      
      return tasks;
    }
    
    function generatePromptTasks() {
      const tasks = [];
      const prompts = [
        { goal: "E-commerce landing page", keywords: ["hero section", "product showcase", "CTA buttons", "trust badges"], difficulty: "medium" },
        { goal: "Portfolio website for photographer", keywords: ["gallery grid", "lightbox", "contact form", "about section"], difficulty: "easy" },
        { goal: "Restaurant website with menu", keywords: ["menu categories", "pricing table", "reservation form", "location map"], difficulty: "medium" },
        { goal: "SaaS pricing page", keywords: ["pricing tiers", "feature comparison", "FAQ accordion", "testimonials"], difficulty: "medium" },
        { goal: "Blog with article cards", keywords: ["post grid", "categories", "search", "pagination"], difficulty: "easy" },
        { goal: "Fitness app dashboard", keywords: ["progress charts", "workout tracker", "calorie counter", "goal setting"], difficulty: "hard" },
        { goal: "Real estate listing page", keywords: ["property cards", "filters", "map integration", "contact agent"], difficulty: "hard" },
        { goal: "Online course platform", keywords: ["course cards", "progress tracking", "video player", "certificate"], difficulty: "hard" },
        { goal: "Event ticketing website", keywords: ["event calendar", "seat selection", "checkout flow", "QR tickets"], difficulty: "hard" },
        { goal: "Job board with listings", keywords: ["job cards", "filters", "application form", "company profiles"], difficulty: "medium" },
        { goal: "Weather dashboard", keywords: ["current weather", "forecast", "location search", "weather icons"], difficulty: "easy" },
        { goal: "Task management app", keywords: ["kanban board", "drag-drop", "due dates", "priority tags"], difficulty: "medium" },
        { goal: "Music streaming interface", keywords: ["playlist", "player controls", "album art", "queue"], difficulty: "hard" },
        { goal: "Social media profile page", keywords: ["profile header", "post feed", "followers", "activity stats"], difficulty: "medium" },
        { goal: "Cryptocurrency tracker", keywords: ["price charts", "portfolio", "news feed", "alerts"], difficulty: "hard" },
        { goal: "Recipe website with search", keywords: ["recipe cards", "ingredients", "cooking steps", "ratings"], difficulty: "easy" },
        { goal: "Travel booking interface", keywords: ["search form", "results grid", "filters", "booking summary"], difficulty: "hard" },
        { goal: "Chat application UI", keywords: ["message threads", "user list", "typing indicator", "emoji picker"], difficulty: "medium" },
        { goal: "Analytics dashboard", keywords: ["data charts", "KPI cards", "date range", "export"], difficulty: "hard" },
        { goal: "Learning management system", keywords: ["course modules", "quiz", "progress bar", "certificate"], difficulty: "hard" }
      ];
      
      prompts.forEach((item, i) => {
        const isPremium = item.difficulty === 'hard';
        tasks.push({
          id: `prompt_${i + 1}`,
          category: 'prompt',
          title: `Generate: ${item.goal}`,
          description: `Create an AI prompt to generate a ${item.goal.toLowerCase()}`,
          instruction: `Goal: Create a detailed AI prompt that will generate a "${item.goal}"\n\nRequired Keywords to include:\n${item.keywords.map(k => `‚Ä¢ ${k}`).join('\n')}\n\nYour prompt must:\n1. Be specific and detailed\n2. Include all required keywords\n3. Specify design style (modern, minimal, etc.)\n4. Define color scheme\n5. List all required components\n6. Mention responsive design requirements\n\nMinimum words: ${isPremium ? 150 : 80}\nMaximum words: ${isPremium ? 400 : 200}`,
          payment: isPremium ? (2.0 + Math.random() * 2).toFixed(2) : (0.1 + Math.random() * 0.5).toFixed(2),
          time: isPremium ? '10-15 min' : '5-8 min',
          premium: isPremium,
          goal: item.goal,
          keywords: item.keywords
        });
      });
      
      return tasks;
    }
    
    function generateTeachTasks() {
      const tasks = [];
      const topics = [
        {
          topic: "AI Impact on Employment",
          question: "How will artificial intelligence reshape the job market over the next decade? Discuss both job displacement and job creation aspects.",
          keywords: ["automation", "reskilling", "gig economy", "universal basic income"],
          caseStudies: ["Amazon warehouse automation", "ChatGPT impact on content writing"],
          minWords: 200,
          maxWords: 500
        },
        {
          topic: "Climate Change Solutions",
          question: "What are the most promising technological solutions to combat climate change, and what barriers prevent their widespread adoption?",
          keywords: ["renewable energy", "carbon capture", "green hydrogen", "policy frameworks"],
          caseStudies: ["Tesla's impact on EV adoption", "Denmark's wind energy success"],
          minWords: 250,
          maxWords: 600
        },
        {
          topic: "Digital Privacy",
          question: "Should governments have the ability to access encrypted communications to prevent crime, or does this fundamentally violate citizens' privacy rights?",
          keywords: ["end-to-end encryption", "surveillance", "GDPR", "digital rights"],
          caseStudies: ["Apple vs FBI case", "Cambridge Analytica scandal"],
          minWords: 200,
          maxWords: 500
        },
        {
          topic: "Cryptocurrency Future",
          question: "Will decentralized cryptocurrencies eventually replace traditional banking systems, or will they remain a niche financial instrument?",
          keywords: ["blockchain", "DeFi", "central bank digital currencies", "volatility"],
          caseStudies: ["El Salvador Bitcoin adoption", "FTX collapse implications"],
          minWords: 220,
          maxWords: 550
        },
        {
          topic: "Social Media Mental Health",
          question: "What responsibility do social media companies have in protecting users' mental health, especially among teenagers?",
          keywords: ["algorithm manipulation", "screen time", "cyberbullying", "content moderation"],
          caseStudies: ["Facebook's internal research leak", "TikTok time limits in China"],
          minWords: 200,
          maxWords: 500
        },
        {
          topic: "Space Exploration Ethics",
          question: "Should we prioritize solving Earth's problems before investing heavily in space exploration and colonization?",
          keywords: ["resource allocation", "technological spinoffs", "planetary protection", "private space companies"],
          caseStudies: ["SpaceX Mars mission", "International Space Station benefits"],
          minWords: 180,
          maxWords: 450
        },
        {
          topic: "Gene Editing Ethics",
          question: "Should CRISPR and similar gene editing technologies be used to enhance human capabilities beyond treating diseases?",
          keywords: ["designer babies", "genetic inequality", "bioethics", "FDA regulation"],
          caseStudies: ["He Jiankui case", "Sickle cell disease treatment trials"],
          minWords: 230,
          maxWords: 550
        },
        {
          topic: "Remote Work Revolution",
          question: "Has the shift to remote work been net positive for society, considering productivity, mental health, and urban development impacts?",
          keywords: ["work-life balance", "office culture", "digital nomads", "urban exodus"],
          caseStudies: ["Twitter's remote work policy", "Zoom fatigue studies"],
          minWords: 200,
          maxWords: 500
        },
        {
          topic: "AI Art and Creativity",
          question: "Should AI-generated art be considered legitimate creative work, and how should copyright laws adapt to this new reality?",
          keywords: ["generative AI", "intellectual property", "creative industries", "training data"],
          caseStudies: ["Midjourney art competitions", "Getty Images lawsuit"],
          minWords: 200,
          maxWords: 500
        },
        {
          topic: "Universal Healthcare",
          question: "What can countries learn from different healthcare systems to create more equitable and efficient medical care?",
          keywords: ["single-payer", "private insurance", "preventive care", "pharmaceutical pricing"],
          caseStudies: ["NHS UK model", "US Affordable Care Act"],
          minWords: 220,
          maxWords: 550
        },
        {
          topic: "Electric Vehicles Adoption",
          question: "What infrastructure and policy changes are needed to achieve widespread electric vehicle adoption globally?",
          keywords: ["charging infrastructure", "battery technology", "grid capacity", "subsidies"],
          caseStudies: ["Norway's EV success", "China's EV market dominance"],
          minWords: 200,
          maxWords: 500
        },
        {
          topic: "Misinformation Combat",
          question: "How can society effectively combat misinformation while preserving freedom of speech and avoiding censorship?",
          keywords: ["fact-checking", "media literacy", "platform responsibility", "echo chambers"],
          caseStudies: ["COVID-19 misinformation", "Election interference"],
          minWords: 220,
          maxWords: 550
        },
        {
          topic: "Future of Education",
          question: "How should traditional education systems adapt to prepare students for an AI-driven future workforce?",
          keywords: ["STEM emphasis", "soft skills", "lifelong learning", "personalized education"],
          caseStudies: ["Khan Academy model", "Finland education reform"],
          minWords: 200,
          maxWords: 500
        },
        {
          topic: "Autonomous Vehicles Ethics",
          question: "How should autonomous vehicles be programmed to make ethical decisions in unavoidable accident scenarios?",
          keywords: ["trolley problem", "liability", "algorithmic ethics", "safety standards"],
          caseStudies: ["Uber autonomous car fatality", "Tesla Autopilot incidents"],
          minWords: 230,
          maxWords: 550
        },
        {
          topic: "Gig Economy Rights",
          question: "Should gig economy workers be entitled to the same benefits and protections as traditional employees?",
          keywords: ["worker classification", "benefits portability", "union rights", "platform economics"],
          caseStudies: ["California AB5", "Uber/Lyft driver classification"],
          minWords: 200,
          maxWords: 500
        },
        {
          topic: "Water Scarcity Solutions",
          question: "What technological and policy innovations are needed to address growing global water scarcity?",
          keywords: ["desalination", "water recycling", "agricultural efficiency", "water pricing"],
          caseStudies: ["Singapore NEWater", "Cape Town Day Zero"],
          minWords: 200,
          maxWords: 500
        },
        {
          topic: "Mental Health Technology",
          question: "Can AI-powered mental health apps effectively supplement or replace traditional therapy?",
          keywords: ["chatbot therapy", "accessibility", "data privacy", "clinical validation"],
          caseStudies: ["Woebot app", "Crisis Text Line AI"],
          minWords: 200,
          maxWords: 500
        },
        {
          topic: "Food Security Future",
          question: "How can technology help ensure global food security in the face of climate change and population growth?",
          keywords: ["vertical farming", "lab-grown meat", "precision agriculture", "food waste reduction"],
          caseStudies: ["Beyond Meat success", "Singapore food tech hub"],
          minWords: 220,
          maxWords: 550
        },
        {
          topic: "Digital Identity Systems",
          question: "Should governments implement centralized digital identity systems, and what safeguards are needed?",
          keywords: ["biometrics", "privacy", "financial inclusion", "surveillance risk"],
          caseStudies: ["India Aadhaar system", "Estonia e-Residency"],
          minWords: 200,
          maxWords: 500
        },
        {
          topic: "Aging Population Economy",
          question: "How should economies adapt to support rapidly aging populations while maintaining productivity?",
          keywords: ["retirement age", "healthcare costs", "automation", "immigration policy"],
          caseStudies: ["Japan's aging crisis", "Germany's skilled worker visa"],
          minWords: 220,
          maxWords: 550
        }
      ];
      
      topics.forEach((item, i) => {
        const isPremium = i > 10;
        tasks.push({
          id: `teach_${i + 1}`,
          category: 'teach',
          title: `Opinion: ${item.topic}`,
          description: `Share your informed opinion on: ${item.topic}`,
          instruction: `Topic: ${item.topic}\n\nQuestion:\n${item.question}\n\nRequired Keywords to address:\n${item.keywords.map(k => `‚Ä¢ ${k}`).join('\n')}\n\nRelevant Case Studies to reference:\n${item.caseStudies.map(c => `‚Ä¢ ${c}`).join('\n')}\n\nYour response must:\n1. Present a clear, well-reasoned opinion\n2. Address ALL required keywords\n3. Reference at least ONE case study\n4. Provide supporting evidence\n5. Consider counterarguments\n6. Conclude with actionable insights\n\nMinimum words: ${item.minWords}\nMaximum words: ${item.maxWords}`,
          payment: isPremium ? (2.5 + Math.random() * 1.5).toFixed(2) : (0.15 + Math.random() * 0.6).toFixed(2),
          time: isPremium ? '15-25 min' : '8-15 min',
          premium: isPremium,
          topic: item.topic,
          question: item.question,
          keywords: item.keywords,
          caseStudies: item.caseStudies,
          minWords: item.minWords,
          maxWords: item.maxWords
        });
      });
      
      return tasks;
    }
    
    // ============ UTILITY FUNCTIONS ============
    function showToast(message, type = 'success') {
      const container = document.getElementById('toastContainer');
      const toast = document.createElement('div');
      const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-yellow-500';
      toast.className = `toast ${bgColor} px-6 py-3 rounded-lg font-medium text-white shadow-lg`;
      toast.textContent = message;
      container.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }
    
    function formatCurrency(usd) {
      return `$${parseFloat(usd).toFixed(2)}`;
    }
    
    function usdToKsh(usd) {
      return Math.round(parseFloat(usd) * KSH_RATE);
    }
    
    function saveToStorage(key, data) {
      localStorage.setItem(`airunner_${key}`, JSON.stringify(data));
    }
    
    function getFromStorage(key) {
      const data = localStorage.getItem(`airunner_${key}`);
      return data ? JSON.parse(data) : null;
    }
    
    // ============ MODAL FUNCTIONS ============
    function showModal(modalId) {
      document.getElementById(modalId).classList.remove('hidden');
      document.getElementById(modalId).classList.add('flex');
    }
    
    function hideModal(modalId) {
      document.getElementById(modalId).classList.add('hidden');
      document.getElementById(modalId).classList.remove('flex');
    }
    
    function switchModal(fromModal, toModal) {
      hideModal(fromModal);
      showModal(toModal);
    }
    
    // ============ UPGRADE FUNCTIONS ============
    function showUpgradePaymentStep() {
      hideModal('upgradeModal');
      window.open('https://lipana.dev/pay/home-trade-top-up', '_blank', 'noopener,noreferrer');
      showToast('Opening MPESA payment page... (KSH 357)', 'info');
    }
    
    function toggleUpgradeAlternative() {
      const step1 = document.getElementById('upgradeStep1');
      const alternative = document.getElementById('upgradeAlternative');
      
      if (alternative.classList.contains('hidden')) {
        step1.classList.add('hidden');
        alternative.classList.remove('hidden');
        document.getElementById('mpesaMessage').focus();
      } else {
        step1.classList.remove('hidden');
        alternative.classList.add('hidden');
        document.getElementById('mpesaValidationFeedback').classList.add('hidden');
      }
    }
    
    function verifyMpesaMessage() {
      const message = document.getElementById('mpesaMessage').value.trim();
      
      if (!message) {
        showToast('Please paste your MPESA confirmation message', 'error');
        return;
      }
      
      if (message.length < 50) {
        showToast('Message too short. Make sure you copied the full confirmation.', 'error');
        return;
      }
      
      const validation = validateMpesaMessage(message);
      
      document.getElementById('mpesaValidationFeedback').classList.remove('hidden');
      
      const checkRecipient = document.getElementById('checkRecipient');
      const checkAmount = document.getElementById('checkAmount');
      const checkDate = document.getElementById('checkDate');
      
      if (validation.recipientValid) {
        checkRecipient.textContent = '‚úì';
        checkRecipient.classList.remove('bg-slate-700');
        checkRecipient.classList.add('bg-green-500/50', 'text-green-300');
      } else {
        checkRecipient.textContent = '‚úó';
        checkRecipient.classList.remove('bg-slate-700');
        checkRecipient.classList.add('bg-red-500/50', 'text-red-300');
      }
      
      if (validation.amountValid) {
        checkAmount.textContent = '‚úì';
        checkAmount.classList.remove('bg-slate-700');
        checkAmount.classList.add('bg-green-500/50', 'text-green-300');
      } else {
        checkAmount.textContent = '‚úó';
        checkAmount.classList.remove('bg-slate-700');
        checkAmount.classList.add('bg-red-500/50', 'text-red-300');
      }
      
      if (validation.dateValid) {
        checkDate.textContent = '‚úì';
        checkDate.classList.remove('bg-slate-700');
        checkDate.classList.add('bg-green-500/50', 'text-green-300');
      } else {
        checkDate.textContent = '‚úó';
        checkDate.classList.remove('bg-slate-700');
        checkDate.classList.add('bg-red-500/50', 'text-red-300');
      }
      
      if (validation.recipientValid && validation.amountValid && validation.dateValid) {
        activatePremium(message, validation);
      } else {
        const missing = [];
        if (!validation.recipientValid) missing.push('Recipient');
        if (!validation.amountValid) missing.push('Amount');
        if (!validation.dateValid) missing.push('Date');
        showToast(`‚ö†Ô∏è Missing: ${missing.join(', ')}`, 'error');
      }
    }
    
    function validateMpesaMessage(message) {
      const messageLower = message.toLowerCase();
      
      const recipientValid = messageLower.includes('lipana') && 
                            (messageLower.includes('technolog') || 
                             messageLower.includes('account number'));
      
      const amountValid = messageLower.includes('357') || message.includes('357.00') || messageLower.includes('ksh 357');
      
      const today = new Date();
      const todayStr = today.getDate().toString();
      const monthStr = (today.getMonth() + 1).toString();
      const yearStr = today.getFullYear().toString().slice(-2);
      
      const datePatterns = [
        `${todayStr}/${monthStr}/${yearStr}`,
        `${todayStr}/${monthStr}`,
        today.toLocaleDateString(),
        todayStr
      ];
      
      const dateValid = datePatterns.some(pattern => message.includes(pattern));
      
      return {
        recipientValid,
        amountValid,
        dateValid,
        isValid: recipientValid && amountValid && dateValid
      };
    }
    
    async function activatePremium(mpesaMessage, validation) {
      if (!currentUser) {
        showToast('Please login first', 'error');
        return;
      }
      
      currentUser.plan = 'premium';
      currentUser.premiumActivatedAt = new Date().toISOString();
      currentUser.mpesaVerification = {
        message: mpesaMessage.substring(0, 100),
        verifiedAt: new Date().toISOString()
      };
      
      saveToStorage('user', currentUser);
      
      await sendToWeb3Form({
        user_name: currentUser.name,
        user_email: currentUser.email,
        user_phone: currentUser.phone,
        plan: 'Premium Upgrade Completed',
        mpesa_verified: 'Yes',
        amount: 'KSH 357',
        activated_at: new Date().toISOString()
      }, 'Premium Activation Verified');
      
      hideModal('upgradeModal');
      updateDashboard();
      renderTasks();
      
      showToast('üéâ Premium activated! Enjoy unlimited tasks! üëë');
    }
    
    async function sendToWeb3Form(data, subject) {
      try {
        const response = await fetch('https://api.web3forms.com/submit', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            access_key: WEB3FORM_KEY,
            to: TARGET_EMAIL,
            subject: `AI Runner: ${subject}`,
            ...data
          })
        });
        return response.ok;
      } catch (e) {
        console.error('Web3Form error:', e);
        return false;
      }
    }
    
    // ============ NAVIGATION FUNCTIONS ============
    function toggleMobileMenu() {
      document.getElementById('mobileMenu').classList.toggle('hidden');
    }
    
    function toggleDashboardMenu() {
      document.getElementById('dashboardMenu').classList.toggle('hidden');
    }
    
    function showDashboardSection(section) {
      const sections = ['dashboardSection', 'tasksSection', 'walletSection', 'plansSection', 'historySection'];
      sections.forEach(s => {
        document.getElementById(s).classList.add('hidden');
      });
      document.getElementById(`${section}Section`).classList.remove('hidden');
      document.getElementById('dashboardMenu').classList.add('hidden');
    }
    
    function showLanding() {
      document.getElementById('landingPage').classList.remove('hidden');
      document.getElementById('dashboardPage').classList.add('hidden');
    }
    
    function showDashboard() {
      document.getElementById('landingPage').classList.add('hidden');
      document.getElementById('dashboardPage').classList.remove('hidden');
      updateDashboard();
      renderTasks();
    }
    
    // ============ AUTH FUNCTIONS ============
    async function handleRegister(e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      
      const user = {
        name: formData.get('name'),
        email: formData.get('email'),
        phone: formData.get('phone'),
        password: formData.get('password'),
        plan: 'free',
        balance: 0,
        totalEarned: 0,
        tasksCompleted: 0,
        todayTasks: 0,
        lastTaskDate: null,
        registeredAt: new Date().toISOString(),
        activities: [],
        earnings: []
      };
      
      saveToStorage('user', user);
      currentUser = user;
      
      await sendToWeb3Form({
        name: user.name,
        email: user.email,
        phone: user.phone,
        registered_at: user.registeredAt
      }, 'New Registration');
      
      hideModal('registerModal');
      showToast('Welcome to AI Runner! üöÄ');
      showDashboard();
      form.reset();
    }
    
    async function handleLogin(e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      
      const storedUser = getFromStorage('user');
      if (storedUser && storedUser.email === formData.get('email')) {
        currentUser = storedUser;
        hideModal('loginModal');
        showToast('Welcome back! üëã');
        showDashboard();
        form.reset();
      } else {
        showToast('Invalid credentials. Please register first.', 'error');
      }
    }
    
    function handleLogout() {
      currentUser = null;
      showToast('Logged out successfully');
      showLanding();
      document.getElementById('dashboardMenu').classList.add('hidden');
    }
    
    // ============ WITHDRAWAL FUNCTIONS ============
    function updateWithdrawalFields() {
      const method = document.querySelector('select[name="method"]').value;
      document.getElementById('mpesaFields').classList.add('hidden');
      document.getElementById('bankFields').classList.add('hidden');
      document.getElementById('paypalFields').classList.add('hidden');
      
      if (method === 'mpesa') {
        document.getElementById('mpesaFields').classList.remove('hidden');
      } else if (method === 'bank') {
        document.getElementById('bankFields').classList.remove('hidden');
      } else if (method === 'paypal') {
        document.getElementById('paypalFields').classList.remove('hidden');
      }
    }
    
    async function handleWithdraw(e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      
      if (!currentUser) {
        showToast('Please login first', 'error');
        return;
      }
      
      const amount = parseFloat(formData.get('amount'));
      const method = formData.get('method');
      const minWithdraw = currentUser.plan === 'premium' ? 5 : 20;
      
      if (amount > currentUser.balance) {
        showToast('Insufficient balance', 'error');
        return;
      }
      
      if (amount < minWithdraw) {
        showToast(`Minimum withdrawal is $${minWithdraw}`, 'error');
        return;
      }
      
      if (currentUser.plan === 'premium') {
        // Check 2x per week limit for premium
        const withdrawals = currentUser.activities.filter(a => a.type === 'withdrawal');
        const thisWeekWithdrawals = withdrawals.filter(w => {
          const wDate = new Date(w.date);
          const weekStart = new Date();
          weekStart.setDate(weekStart.getDate() - weekStart.getDay());
          return wDate >= weekStart;
        }).length;
        
        if (thisWeekWithdrawals >= 2) {
          const nextWithdrawalDate = new Date();
          nextWithdrawalDate.setDate(nextWithdrawalDate.getDate() - nextWithdrawalDate.getDay() + 7);
          showToast(`Weekly limit reached! Next withdrawal available ${nextWithdrawalDate.toLocaleDateString()}`, 'error');
          return;
        }
      } else {
        // Free plan: 25 days waiting period
        const registeredDate = new Date(currentUser.registeredAt);
        const daysSince = Math.floor((Date.now() - registeredDate) / (1000 * 60 * 60 * 24));
        if (daysSince < 25) {
          showToast(`Withdrawals available in ${25 - daysSince} days`, 'error');
          return;
        }
      }
      
      let accountDetails = '';
      if (method === 'mpesa') {
        accountDetails = formData.get('mpesa_phone');
      } else if (method === 'bank') {
        accountDetails = formData.get('bank_details');
      } else if (method === 'paypal') {
        accountDetails = formData.get('paypal_email');
      }
      
      await sendToWeb3Form({
        user_name: currentUser.name,
        user_email: currentUser.email,
        user_phone: currentUser.phone,
        amount: `$${amount}`,
        method: method,
        account_details: accountDetails,
        user_plan: currentUser.plan
      }, 'Withdrawal Request');
      
      currentUser.balance -= amount;
      currentUser.activities.unshift({
        type: 'withdrawal',
        amount: amount,
        method: method,
        accountDetails: accountDetails,
        date: new Date().toISOString(),
        status: 'pending'
      });
      
      saveToStorage('user', currentUser);
      updateDashboard();
      
      hideModal('withdrawModal');
      showToast('Withdrawal request submitted! üéâ');
      form.reset();
    }
    
    // ============ SUPPORT FUNCTIONS ============
    async function handleSupport(e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      
      await sendToWeb3Form({
        user_name: currentUser?.name || 'Guest',
        user_email: currentUser?.email || 'Not logged in',
        subject: formData.get('subject'),
        message: formData.get('message')
      }, 'Support Ticket');
      
      hideModal('supportModal');
      showToast('Support ticket sent! We\'ll respond soon. üõü');
      form.reset();
    }
    
    // ============ EXTERNAL LINK FUNCTIONS ============
    function handleExternalLink(type) {
      const links = {
        chat: { url: 'https://www.chat.com', name: 'Chat and Earn' },
        prime: { url: 'https://www.primewatch.com', name: 'Prime Watch' }
      };
      
      const link = links[type];
      document.getElementById('externalLinkMessage').textContent = 
        `You are about to visit ${link.name}, an external website. This is not part of AI Runner.`;
      document.getElementById('externalLinkBtn').href = link.url;
      
      showModal('externalLinkModal');
      document.getElementById('dashboardMenu').classList.add('hidden');
    }
    
    // ============ TASK FUNCTIONS ============
    function getAllTasks() {
      return [
        ...tasksDatabase.chat,
        ...tasksDatabase.rewrite,
        ...tasksDatabase.translation,
        ...tasksDatabase.prompt,
        ...tasksDatabase.teach
      ];
    }
    
    function filterTasks(category) {
      currentFilter = category;
      
      document.querySelectorAll('.task-filter-btn').forEach(btn => {
        if (btn.dataset.filter === category) {
          btn.classList.add('bg-cyan-500/20', 'text-cyan-300');
          btn.classList.remove('bg-slate-700/50', 'text-gray-300');
        } else {
          btn.classList.remove('bg-cyan-500/20', 'text-cyan-300');
          btn.classList.add('bg-slate-700/50', 'text-gray-300');
        }
      });
      
      renderTasks();
    }
    
    function renderTasks() {
      const container = document.getElementById('tasksList');
      const quickContainer = document.getElementById('quickTasks');
      
      let tasks = currentFilter === 'all' ? getAllTasks() : tasksDatabase[currentFilter] || [];
      
      const isPremium = currentUser?.plan === 'premium';
      
      container.innerHTML = tasks.map((task, index) => {
        const locked = task.premium && !isPremium;
        const cardClass = index % 2 === 0 ? 'neon-card' : 'neon-card-alt';
        const textClass = index % 2 === 0 ? 'text-cyan-300' : 'text-purple-300';
        
        return `
          <div class="${cardClass} flag-border rounded-xl p-4 ${locked ? 'task-locked' : ''} animate-slideIn" style="animation-delay: ${index * 0.05}s">
            <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
              <div class="flex-1">
                <div class="flex items-center gap-2 mb-2">
                  <span class="text-xs px-2 py-1 rounded-full ${task.premium ? 'bg-yellow-500/20 text-yellow-300' : 'bg-green-500/20 text-green-300'}">
                    ${task.premium ? 'üëë Premium' : 'üÜì Free'}
                  </span>
                  <span class="text-xs px-2 py-1 rounded-full bg-slate-700/50 text-gray-300">${task.category.toUpperCase()}</span>
                </div>
                <h4 class="font-semibold ${textClass} mb-1">${task.title}</h4>
                <p class="text-sm text-gray-400">${task.description}</p>
              </div>
              <div class="flex items-center gap-4">
                <div class="text-right">
                  <p class="font-orbitron text-lg font-bold text-green-400">$${task.payment}</p>
                  <p class="text-xs text-gray-400">‚è± ${task.time}</p>
                </div>
                <button onclick="viewTask('${task.id}')" class="${locked ? 'bg-slate-700 cursor-not-allowed' : 'btn-neon'} px-4 py-2 rounded-full font-semibold text-sm" ${locked ? 'disabled' : ''}>
                  ${locked ? 'üîí Locked' : 'View Task'}
                </button>
              </div>
            </div>
          </div>
        `;
      }).join('');
      
      const quickTasks = getAllTasks().filter(t => !t.premium || isPremium).slice(0, 5);
      quickContainer.innerHTML = quickTasks.map((task, index) => {
        const cardClass = index % 2 === 0 ? 'neon-card' : 'neon-card-alt';
        return `
          <div class="${cardClass} rounded-lg p-4 flex items-center justify-between">
            <div>
              <p class="font-medium text-white">${task.title.substring(0, 40)}...</p>
              <p class="text-xs text-gray-400">${task.category.toUpperCase()} ‚Ä¢ ${task.time}</p>
            </div>
            <div class="flex items-center gap-3">
              <span class="font-orbitron text-green-400 font-bold">$${task.payment}</span>
              <button onclick="viewTask('${task.id}')" class="btn-neon-purple px-3 py-1 rounded-full text-sm text-white">Start</button>
            </div>
          </div>
        `;
      }).join('');
    }
    
    function viewTask(taskId) {
      const task = getAllTasks().find(t => t.id === taskId);
      if (!task) return;
      
      const isPremium = currentUser?.plan === 'premium';
      if (task.premium && !isPremium) {
        showToast('Upgrade to Premium to access this task! üëë', 'info');
        return;
      }
      
      document.getElementById('taskModalTitle').textContent = task.title;
      document.getElementById('taskModalContent').innerHTML = `
        <div class="space-y-4">
          <div class="flex items-center gap-4 flex-wrap">
            <span class="text-sm px-3 py-1 rounded-full ${task.premium ? 'bg-yellow-500/20 text-yellow-300' : 'bg-green-500/20 text-green-300'}">
              ${task.premium ? 'üëë Premium Task' : 'üÜì Free Task'}
            </span>
            <span class="text-sm px-3 py-1 rounded-full bg-slate-700/50 text-gray-300">${task.category.toUpperCase()}</span>
            <span class="text-sm text-gray-400">‚è± Estimated: ${task.time}</span>
          </div>
          
          <div class="bg-green-500/10 border border-green-500/30 rounded-lg p-4 text-center">
            <p class="text-sm text-green-300 mb-1">Reward for completion</p>
            <p class="font-orbitron text-3xl font-bold text-green-400">$${task.payment}</p>
            <p class="text-xs text-green-300/70">KSH ${usdToKsh(task.payment)}</p>
          </div>
          
          <div>
            <h4 class="font-semibold text-yellow-300 mb-2">üìã Task Description</h4>
            <p class="text-gray-300">${task.description}</p>
          </div>
          
          <div class="bg-slate-800/50 rounded-lg p-4">
            <h4 class="font-semibold text-yellow-300 mb-3">üìù Instructions</h4>
            <pre class="text-gray-300 whitespace-pre-wrap text-sm leading-relaxed">${task.instruction}</pre>
          </div>
          
          <div class="space-y-3">
            <label class="block text-sm text-gray-300">Your Response:</label>
            <textarea id="taskResponse" rows="6" class="w-full bg-slate-800/50 border border-yellow-500/30 rounded-lg px-4 py-3 text-white focus:border-yellow-400 focus:outline-none resize-none" placeholder="Enter your response here..."></textarea>
          </div>
          
          <div class="flex gap-4">
            <button onclick="hideModal('taskModal')" class="flex-1 bg-slate-700 hover:bg-slate-600 py-3 rounded-full font-semibold transition">
              Cancel
            </button>
            <button onclick="submitTask('${task.id}')" class="flex-1 btn-neon-gold py-3 rounded-full font-bold text-slate-900">
              ‚úÖ Submit Task
            </button>
          </div>
        </div>
      `;
      
      showModal('taskModal');
    }
    
    function submitTask(taskId) {
      const response = document.getElementById('taskResponse').value.trim();
      
      if (!response) {
        showToast('Please enter your response', 'error');
        return;
      }
      
      if (response.length < 20) {
        showToast('Response too short. Please provide more detail.', 'error');
        return;
      }
      
      const task = getAllTasks().find(t => t.id === taskId);
      if (!task) return;
      
      if (currentUser.plan === 'free') {
        const today = new Date().toDateString();
        if (currentUser.lastTaskDate !== today) {
          currentUser.todayTasks = 0;
          currentUser.lastTaskDate = today;
        }
        
        if (currentUser.todayTasks >= 20) {
          showToast('Daily task limit reached! Upgrade to Premium for unlimited tasks.', 'error');
          return;
        }
      }
      
      hideModal('taskModal');
      showReviewModal(task, response);
    }
    
    function showReviewModal(task, response) {
      const reviewContainer = document.getElementById('liveReviewContent');
      
      reviewContainer.innerHTML = `
        <div class="text-center py-12">
          <div class="rotating-progress rotating-progress-gold mx-auto mb-4"></div>
          <p class="text-gray-300 font-medium">üîç Analyzing your submission...</p>
        </div>
      `;
      
      document.getElementById('liveReviewModal').classList.remove('hidden');
      document.getElementById('liveReviewModal').classList.add('flex');
      
      setTimeout(() => {
        evaluateSubmission(task, response);
      }, 2000);
    }
    
    function evaluateSubmission(task, response) {
      let scoreData = {};
      
      if (task.category === 'chat') {
        scoreData = evaluateChatTask(task, response);
      } else if (task.category === 'rewrite') {
        scoreData = evaluateRewriteTask(task, response);
      } else if (task.category === 'translation') {
        scoreData = evaluateTranslationTask(task, response);
      } else if (task.category === 'prompt') {
        scoreData = evaluatePromptTask(task, response);
      } else if (task.category === 'teach') {
        scoreData = evaluateTeachTask(task, response);
      }
      
      displayReviewScore(task, response, scoreData);
    }
    
    function evaluateChatTask(task, response) {
      const score = {
        total: 0,
        criteria: []
      };
      
      const wordCount = response.split(/\s+/).length;
      const lengthScore = Math.min(100, (wordCount / 50) * 100);
      score.criteria.push({
        name: 'Response Length',
        score: Math.round(lengthScore),
        feedback: wordCount < 30 ? '‚ö†Ô∏è Consider more detail' : '‚úì Good depth'
      });
      
      const hasContraction = /('ve|'re|'ll|'d|n't|'m|'s)/i.test(response);
      const hasVariation = /[!?]/.test(response);
      const naturalScore = (hasContraction ? 40 : 0) + (hasVariation ? 30 : 0) + (lengthScore > 60 ? 30 : 0);
      score.criteria.push({
        name: 'Naturalness',
        score: Math.round(naturalScore),
        feedback: naturalScore > 80 ? '‚úì Sounds natural' : (naturalScore > 50 ? '‚ö†Ô∏è Could be more natural' : '‚úó Needs improvement')
      });
      
      const focusKeywords = task.focus.split(/\s+/).filter(w => w.length > 3);
      const mentionsKeywords = focusKeywords.some(kw => response.toLowerCase().includes(kw.toLowerCase()));
      const focusScore = (mentionsKeywords || response.toLowerCase().includes(task.focus.toLowerCase())) ? 100 : 50;
      score.criteria.push({
        name: 'Focus Area Coverage',
        score: focusScore,
        feedback: focusScore > 75 ? `‚úì Addresses ${task.focus}` : `‚ö†Ô∏è Could better address ${task.focus}`
      });
      
      const hasContext = response.length > 100;
      const contextScore = hasContext ? 100 : 70;
      score.criteria.push({
        name: 'Context & Depth',
        score: contextScore,
        feedback: contextScore > 75 ? '‚úì Well-contextualized' : '‚ö†Ô∏è Add more context'
      });
      
      score.total = Math.round((score.criteria.reduce((sum, c) => sum + c.score, 0) / score.criteria.length));
      return score;
    }
    
    function evaluateRewriteTask(task, response) {
      const score = {
        total: 0,
        criteria: []
      };
      
      const hasErrors = /\b(error|wrong|incorrect|should be|fix|improve)\b/i.test(response);
      const errorScore = hasErrors ? 100 : 40;
      score.criteria.push({
        name: 'Error Identification',
        score: errorScore,
        feedback: errorScore > 75 ? '‚úì Errors identified' : '‚úó Errors not identified'
      });
      
      const wordCount = response.split(/\s+/).length;
      const explanationScore = Math.min(100, (wordCount / 60) * 100);
      score.criteria.push({
        name: 'Explanation Quality',
        score: Math.round(explanationScore),
        feedback: explanationScore > 70 ? '‚úì Clear explanation' : '‚ö†Ô∏è Explain more'
      });
      
      const hasCorrection = response.toLowerCase().includes('should be') || 
                           response.toLowerCase().includes('correct') ||
                           response.toLowerCase().includes('instead');
      const correctionScore = hasCorrection ? 100 : 50;
      score.criteria.push({
        name: 'Provides Correction',
        score: correctionScore,
        feedback: correctionScore > 75 ? '‚úì Correct version provided' : '‚ö†Ô∏è Provide corrected version'
      });
      
      const ruleScore = response.toLowerCase().includes('rule') || 
                       response.toLowerCase().includes('grammar') ||
                       response.toLowerCase().includes('agreement') ? 90 : 60;
      score.criteria.push({
        name: 'Grammar Rule Explanation',
        score: ruleScore,
        feedback: ruleScore > 75 ? '‚úì Rules explained' : '‚ö†Ô∏è Explain grammar rules'
      });
      
      score.total = Math.round((score.criteria.reduce((sum, c) => sum + c.score, 0) / score.criteria.length));
      return score;
    }
    
    function evaluateTranslationTask(task, response) {
      const score = {
        total: 0,
        criteria: []
      };
      
      const wordCount = response.split(/\s+/).length;
      const lengthScore = Math.min(100, (wordCount / 40) * 100);
      score.criteria.push({
        name: 'Translation Completeness',
        score: Math.round(lengthScore),
        feedback: lengthScore > 70 ? '‚úì Complete translation' : '‚ö†Ô∏è Add more detail'
      });
      
      const hasAccuracy = response.length > 30;
      const accuracyScore = hasAccuracy ? 85 : 50;
      score.criteria.push({
        name: 'Translation Accuracy',
        score: accuracyScore,
        feedback: accuracyScore > 75 ? '‚úì Looks accurate' : '‚ö†Ô∏è Verify accuracy'
      });
      
      const contextMatch = task.direction && task.context;
      const contextScore = (contextMatch && response.length > 25) ? 100 : 70;
      score.criteria.push({
        name: 'Context Appropriateness',
        score: contextScore,
        feedback: contextScore > 75 ? `‚úì Fits ${task.context} context` : '‚ö†Ô∏è Consider context'
      });
      
      const hasExplanation = response.toLowerCase().includes('explain') || 
                            response.toLowerCase().includes('note') ||
                            response.toLowerCase().includes('idiom') ||
                            response.toLowerCase().includes('cultural');
      const explanationScore = hasExplanation ? 100 : 70;
      score.criteria.push({
        name: 'Explanation Quality',
        score: explanationScore,
        feedback: hasExplanation ? '‚úì Good contextual notes' : '‚ö†Ô∏è Add cultural context'
      });
      
      score.total = Math.round((score.criteria.reduce((sum, c) => sum + c.score, 0) / score.criteria.length));
      return score;
    }
    
    function evaluatePromptTask(task, response) {
      const score = {
        total: 0,
        criteria: []
      };
      
      const wordCount = response.split(/\s+/).length;
      const detailScore = Math.min(100, (wordCount / 100) * 100);
      score.criteria.push({
        name: 'Prompt Detail & Specificity',
        score: Math.round(detailScore),
        feedback: detailScore > 70 ? '‚úì Very detailed prompt' : '‚ö†Ô∏è Add more specifics'
      });
      
      const keywordMatches = task.keywords.filter(kw => 
        response.toLowerCase().includes(kw.toLowerCase())
      ).length;
      const keywordScore = (keywordMatches / task.keywords.length) * 100;
      score.criteria.push({
        name: 'Required Keywords Coverage',
        score: Math.round(keywordScore),
        feedback: keywordScore > 70 ? '‚úì All keywords included' : `‚ö†Ô∏è Missing ${task.keywords.length - keywordMatches} keywords`
      });
      
      const hasDesignSpecs = /design|style|color|layout|responsive|modern|minimal/i.test(response);
      const designScore = hasDesignSpecs ? 100 : 60;
      score.criteria.push({
        name: 'Design Specifications',
        score: designScore,
        feedback: designScore > 75 ? '‚úì Design clearly specified' : '‚ö†Ô∏è Add design details'
      });
      
      const hasComponents = /component|element|section|button|form|field/i.test(response);
      const componentScore = hasComponents ? 100 : 70;
      score.criteria.push({
        name: 'Component Clarity',
        score: componentScore,
        feedback: componentScore > 75 ? '‚úì Components well-defined' : '‚ö†Ô∏è Define components clearly'
      });
      
      score.total = Math.round((score.criteria.reduce((sum, c) => sum + c.score, 0) / score.criteria.length));
      return score;
    }
    
    function evaluateTeachTask(task, response) {
      const score = {
        total: 0,
        criteria: []
      };
      
      const wordCount = response.split(/\s+/).length;
      const minWords = task.minWords || 200;
      const maxWords = task.maxWords || 500;
      const lengthScore = (wordCount >= minWords && wordCount <= maxWords) ? 100 : 
                         (wordCount > maxWords) ? 60 : (wordCount > minWords * 0.7) ? 80 : 50;
      score.criteria.push({
        name: 'Word Count Compliance',
        score: lengthScore,
        feedback: `${wordCount} words (${minWords}-${maxWords} required). ${lengthScore === 100 ? '‚úì Perfect!' : '‚ö†Ô∏è Adjust length'}`
      });
      
      const keywordMatches = (task.keywords || []).filter(kw => 
        response.toLowerCase().includes(kw.toLowerCase())
      ).length;
      const keywordScore = task.keywords ? (keywordMatches / task.keywords.length) * 100 : 50;
      score.criteria.push({
        name: 'Required Keywords',
        score: Math.round(keywordScore),
        feedback: keywordScore > 70 ? `‚úì ${keywordMatches}/${task.keywords.length} keywords` : `‚ö†Ô∏è Only ${keywordMatches}/${task.keywords.length}`
      });
      
      const caseStudyMatches = (task.caseStudies || []).filter(cs => 
        response.toLowerCase().includes(cs.toLowerCase().split(' ')[0])
      ).length;
      const caseStudyScore = task.caseStudies ? Math.min(100, (caseStudyMatches / Math.max(1, task.caseStudies.length)) * 100) : 50;
      score.criteria.push({
        name: 'Case Study References',
        score: Math.round(caseStudyScore),
        feedback: caseStudyMatches > 0 ? `‚úì ${caseStudyMatches} case study(ies) cited` : '‚ö†Ô∏è Add case studies'
      });
      
      const hasOpinion = /i believe|i think|my opinion|should|must|need|important|however|alternatively|contrary/i.test(response);
      const opinionScore = hasOpinion ? 100 : 60;
      score.criteria.push({
        name: 'Opinion Clarity & Argumentation',
        score: opinionScore,
        feedback: opinionScore > 75 ? '‚úì Strong position articulated' : '‚ö†Ô∏è State opinion more clearly'
      });
      
      score.total = Math.round((score.criteria.reduce((sum, c) => sum + c.score, 0) / score.criteria.length));
      return score;
    }
    
    function displayReviewScore(task, response, scoreData) {
      const finalScore = scoreData.total;
      const paymentMultiplier = finalScore / 100;
      const finalPayment = (parseFloat(task.payment) * paymentMultiplier).toFixed(2);
      const isAccepted = finalScore >= 70;
      
      const reviewContainer = document.getElementById('liveReviewContent');
      
      const scoreColor = finalScore >= 85 ? 'text-green-400' : finalScore >= 70 ? 'text-yellow-400' : 'text-red-400';
      const scoreBg = finalScore >= 85 ? 'bg-green-500/20 border-green-500/30' : finalScore >= 70 ? 'bg-yellow-500/20 border-yellow-500/30' : 'bg-red-500/20 border-red-500/30';
      
      reviewContainer.innerHTML = `
        <div class="space-y-6">
          <!-- Review Title -->
          <div class="text-center border-b border-gray-600 pb-4">
            <p class="text-gray-400 mb-2">Quality Assessment</p>
            <h3 class="font-orbitron text-2xl font-bold text-gray-200">Task Review Complete</h3>
          </div>
          
          <!-- Final Score Display -->
          <div class="text-center">
            <div class="inline-flex flex-col items-center mb-4">
              <div class="relative w-32 h-32 mx-auto mb-4">
                <svg viewBox="0 0 120 120" class="w-full h-full transform -rotate-90">
                  <circle cx="60" cy="60" r="54" fill="none" stroke="rgba(100, 200, 255, 0.2)" stroke-width="8"></circle>
                  <circle cx="60" cy="60" r="54" fill="none" stroke="#00d4ff" stroke-width="8" stroke-dasharray="${(finalScore / 100) * 340} 340" stroke-linecap="round" class="transition-all duration-1000"></circle>
                </svg>
                <div class="absolute inset-0 flex flex-col items-center justify-center">
                  <span class="font-orbitron text-4xl font-bold ${scoreColor}">${finalScore}</span>
                  <span class="text-xs text-gray-400">/ 100</span>
                </div>
              </div>
            </div>
            
            <p class="text-lg font-semibold text-gray-200 mb-2">
              ${isAccepted ? '‚úÖ Submission Accepted!' : '‚ùå Submission Rejected'}
            </p>
            <p class="text-sm text-gray-400 mb-6">
              ${isAccepted ? 'Your work meets our quality standards.' : 'Please review feedback and try again.'}
            </p>
          </div>
          
          <!-- Detailed Criteria Breakdown -->
          <div class="space-y-3 max-h-48 overflow-y-auto scrollbar-thin">
            <p class="text-sm font-semibold text-gray-300 mb-3">üìä Evaluation Breakdown</p>
            ${scoreData.criteria.map(criterion => `
              <div class="bg-slate-800/50 rounded-lg p-3">
                <div class="flex items-center justify-between mb-2">
                  <span class="text-sm font-medium text-gray-300">${criterion.name}</span>
                  <span class="font-orbitron text-sm font-bold ${criterion.score >= 80 ? 'text-green-400' : criterion.score >= 60 ? 'text-yellow-400' : 'text-red-400'}">${criterion.score}%</span>
                </div>
                <div class="w-full bg-slate-900/50 rounded-full h-1.5 overflow-hidden">
                  <div class="bg-gradient-to-r ${criterion.score >= 80 ? 'from-green-400 to-green-600' : criterion.score >= 60 ? 'from-yellow-400 to-yellow-600' : 'from-red-400 to-red-600'} h-full transition-all duration-500" style="width: ${criterion.score}%"></div>
                </div>
                <p class="text-xs text-gray-400 mt-1">${criterion.feedback}</p>
              </div>
            `).join('')}
          </div>
          
          <!-- Payment Info -->
          <div class="border-t border-gray-600 pt-4">
            <div class="bg-gradient-to-r from-green-500/10 to-emerald-500/10 border border-green-500/30 rounded-lg p-4 text-center">
              ${isAccepted ? `
                <p class="text-green-300 text-sm mb-1">üí∞ You Earned</p>
                <p class="font-orbitron text-3xl font-bold text-green-400">$${finalPayment}</p>
                <p class="text-xs text-green-300/70 mt-1">KSH ${usdToKsh(finalPayment)}</p>
                <p class="text-xs text-green-300/50 mt-2">${finalScore < 85 ? `(Score multiplier: ${(paymentMultiplier * 100).toFixed(0)}%)` : '(Full payment: Excellent work!)'}</p>
              ` : `
                <p class="text-red-300 text-sm mb-1">‚ùå Payment Denied</p>
                <p class="font-orbitron text-2xl font-bold text-red-400">$0.00</p>
                <p class="text-xs text-red-300/70 mt-1">Score below 70% minimum</p>
              `}
            </div>
          </div>
          
          <!-- Action Buttons -->
          <div class="flex gap-4 pt-4 border-t border-gray-600">
            ${isAccepted ? `
              <button onclick="confirmTaskSubmission()" class="flex-1 btn-neon-gold py-3 rounded-full font-bold text-slate-900">
                ‚úÖ Claim Reward
              </button>
            ` : `
              <button onclick="document.getElementById('liveReviewModal').classList.add('hidden'); document.getElementById('liveReviewModal').classList.remove('flex');" class="flex-1 bg-slate-700 hover:bg-slate-600 py-3 rounded-full font-semibold transition">
                Edit Response
              </button>
              <button onclick="document.getElementById('liveReviewModal').classList.add('hidden'); document.getElementById('liveReviewModal').classList.remove('flex');" class="flex-1 btn-neon py-3 rounded-full font-semibold">
                Try Another Task
              </button>
            `}
          </div>
        </div>
      `;
      
      window.currentSubmission = {
        task: task,
        response: response,
        score: finalScore,
        payment: finalPayment,
        isAccepted: isAccepted
      };
    }
    
    function confirmTaskSubmission() {
      const submission = window.currentSubmission;
      
      if (!currentUser || !submission.isAccepted) {
        showToast('Cannot process this submission', 'error');
        return;
      }
      
      if (currentUser.plan === 'free') {
        const today = new Date().toDateString();
        if (currentUser.lastTaskDate !== today) {
          currentUser.todayTasks = 0;
          currentUser.lastTaskDate = today;
        }
        
        if (currentUser.todayTasks >= 20) {
          showToast('Daily task limit reached!', 'error');
          return;
        }
      }
      
      const payment = parseFloat(submission.payment);
      currentUser.balance += payment;
      currentUser.totalEarned += payment;
      currentUser.tasksCompleted += 1;
      currentUser.todayTasks += 1;
      
      const activity = {
        type: 'task',
        taskId: submission.task.id,
        taskTitle: submission.task.title,
        amount: payment,
        score: submission.score,
        date: new Date().toISOString()
      };
      
      currentUser.activities.unshift(activity);
      currentUser.earnings.unshift(activity);
      
      saveToStorage('user', currentUser);
      
      document.getElementById('liveReviewModal').classList.add('hidden');
      document.getElementById('liveReviewModal').classList.remove('flex');
      
      showToast(`üéâ Task Approved! +$${submission.payment} earned with ${submission.score}% quality score!`);
      updateDashboard();
      renderTasks();
    }
    
    // ============ DASHBOARD FUNCTIONS ============
    function updateDashboard() {
      if (!currentUser) return;
      
      document.getElementById('userName').textContent = currentUser.name;
      document.getElementById('dashboardUserName').textContent = currentUser.name.split(' ')[0];
      
      const planBadge = document.getElementById('userPlanBadge');
      if (currentUser.plan === 'premium') {
        planBadge.textContent = 'üëë PREMIUM';
        planBadge.classList.remove('bg-cyan-500/20', 'text-cyan-300');
        planBadge.classList.add('bg-yellow-500/20', 'text-yellow-300');
      } else {
        planBadge.textContent = 'FREE';
        planBadge.classList.add('bg-cyan-500/20', 'text-cyan-300');
        planBadge.classList.remove('bg-yellow-500/20', 'text-yellow-300');
      }
      
      const balance = currentUser.balance.toFixed(2);
      const balanceKsh = usdToKsh(currentUser.balance);
      document.getElementById('walletBalance').textContent = `$${balance}`;
      document.getElementById('balanceKsh').textContent = `KSH ${balanceKsh.toLocaleString()}`;
      document.getElementById('walletBalanceLarge').textContent = `$${balance}`;
      document.getElementById('walletBalanceKsh').textContent = `KSH ${balanceKsh.toLocaleString()}`;
      
      document.getElementById('tasksCompleted').textContent = currentUser.tasksCompleted;
      document.getElementById('totalEarned').textContent = `$${currentUser.totalEarned.toFixed(2)}`;
      document.getElementById('todayTasks').textContent = currentUser.plan === 'premium' ? '‚àû' : `${currentUser.todayTasks}/20`;
      document.getElementById('accountType').textContent = currentUser.plan.toUpperCase();
      
      const freePlanBtn = document.getElementById('freePlanBtn');
      const premiumPlanBtn = document.getElementById('premiumPlanBtn');
      
      if (currentUser.plan === 'premium') {
        freePlanBtn.innerHTML = '<span class="text-gray-400">Free Plan</span>';
        premiumPlanBtn.textContent = '‚úÖ Current Plan';
        premiumPlanBtn.disabled = true;
        premiumPlanBtn.classList.remove('btn-neon-gold');
        premiumPlanBtn.classList.add('bg-green-500/20', 'text-green-300', 'cursor-default');
      }
      
      const activityContainer = document.getElementById('recentActivity');
      if (currentUser.activities.length === 0) {
        activityContainer.innerHTML = '<p class="text-gray-400 text-center py-4">No recent activity yet. Start completing tasks!</p>';
      } else {
        activityContainer.innerHTML = currentUser.activities.slice(0, 10).map((activity, i) => {
          const date = new Date(activity.date).toLocaleDateString();
          const cardClass = i % 2 === 0 ? 'bg-slate-800/30' : 'bg-purple-900/20';
          
          if (activity.type === 'task') {
            return `
              <div class="${cardClass} rounded-lg p-3 flex items-center justify-between">
                <div>
                  <p class="text-sm text-white">‚úÖ ${activity.taskTitle.substring(0, 30)}...</p>
                  <p class="text-xs text-gray-400">${date} ‚Ä¢ Score: ${activity.score}%</p>
                </div>
                <span class="font-orbitron text-green-400 font-bold">+$${activity.amount.toFixed(2)}</span>
              </div>
            `;
          } else if (activity.type === 'withdrawal') {
            return `
              <div class="${cardClass} rounded-lg p-3 flex items-center justify-between">
                <div>
                  <p class="text-sm text-white">üí∏ Withdrawal (${activity.method})</p>
                  <p class="text-xs text-gray-400">${date} ‚Ä¢ ${activity.status}</p>
                </div>
                <span class="font-orbitron text-red-400 font-bold">-$${activity.amount.toFixed(2)}</span>
              </div>
            `;
          }
        }).join('');
      }
      
      const historyContainer = document.getElementById('earningsHistory');
      if (currentUser.earnings.length === 0) {
        historyContainer.innerHTML = '<p class="text-gray-400 text-center py-8">No earnings history yet. Complete tasks to start earning!</p>';
      } else {
        historyContainer.innerHTML = currentUser.earnings.map((earning, i) => {
          const date = new Date(earning.date).toLocaleDateString();
          const time = new Date(earning.date).toLocaleTimeString();
          const cardClass = i % 2 === 0 ? 'neon-card' : 'neon-card-alt';
          
          return `
            <div class="${cardClass} rounded-lg p-4 flex items-center justify-between">
              <div>
                <p class="text-sm text-white font-medium">${earning.taskTitle}</p>
                <p class="text-xs text-gray-400">${date} at ${time} ‚Ä¢ Quality: ${earning.score}%</p>
              </div>
              <div class="text-right">
                <p class="font-orbitron text-green-400 font-bold">+$${earning.amount.toFixed(2)}</p>
                <p class="text-xs text-gray-400">KSH ${usdToKsh(earning.amount)}</p>
              </div>
            </div>
          `;
        }).join('');
      }
    }
    
    function toggleCurrency() {
      showToast('Currency: 1 USD = KSH 129', 'info');
    }
    
    // ============ INITIALIZATION ============
    function init() {
      currentUser = getFromStorage('user');
      
      if (currentUser) {
        const today = new Date().toDateString();
        if (currentUser.lastTaskDate !== today) {
          currentUser.todayTasks = 0;
          currentUser.lastTaskDate = today;
          saveToStorage('user', currentUser);
        }
        
        showDashboard();
      } else {
        showLanding();
      }
    }
    
    // Element SDK initialization
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (config) => {
          document.getElementById('heroHeadline').textContent = config.hero_headline || defaultConfig.hero_headline;
          document.getElementById('heroSubtext').innerHTML = config.hero_subtext || defaultConfig.hero_subtext;
        },
        mapToCapabilities: (config) => ({
          recolorables: [],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (config) => new Map([
          ['hero_headline', config.hero_headline || defaultConfig.hero_headline],
          ['hero_subtext', config.hero_subtext || defaultConfig.hero_subtext]
        ])
      });
    }
    
    // Start the app
    init();
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9cf4e91765c0b280',t:'MTc3MTMyNzM4NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>